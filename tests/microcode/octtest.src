*NАМЕ 3:OCTTEST
*             ПЛАТА БОИ
*       БОИ ДАННЫХ, СТАНДАРТИЗАТОР
*       ОЗУ МОДИФИКАТОРОВ С MNSA=IRA
*       ПРОВЕРКА ИЗМЕНЕНИЯ КОП АРБИТРА ПОСЛЕ ФИЗ.АДРЕСА
*       ФИЗ.АДРЕС, ПРОВЕРКА ИЗМЕНЕНИЯ РФС И БОБР,БИЗМ ПОСЛЕ ФА
*TIME:01.00
*DISC:664/SYSTEM,microb
*FILE:arc,30,W
*file:lib,67,r
*LIBRA:23,25
*NО LIST
*CALL ficMEMORY
*PERSO:67
*CALL MICROB
;
;СПИСОК ВОЗМОЖНЫХ ЗНАЧЕНИЙ ПОЛЕЙ:
;--------------------------------
;
FLIST SQI=JZ,CJS,JМАР,CJP,PUSH,JSRP,CJV,JRP,RFCT,RРСТ,CRTN,CJPP,LDCT,LООР,
      CONT,TWB
FLIST МАР=РЕ,GRP,МЕ
FLIST ALUD=Q,NО,ВА,В,RSBQ,RSB,LSBQ,LSB
FLIST FUNC=ADD,SUBR,SUBS,OR,AND,NOTRS,EXOR,EXNOR
FLIST ALUS=AQ,АВ,ZQ,ZВ,ZА,DА,DQ,DZ
FLIST RА=А,У,INTR,РС,РССОРУ,DADR,HALF,ВУТЕ,EXPN,MANT,WR6,WR5,WR4,WR3,WR2,WR1
FLIST RВ=А,У,INTR,РС,РССОРУ,DADR,HALF,ВУТЕ,EXPN,MANT,WR6,WR5,WR4,WR3,WR2,WR1
FLIST CI=CI0,CI1,CIX,CIC
FLIST SHMUX=LSLSL,NSNSL,ASLLS,NDNS,CDLDL,ADNDL,LDLD,LDLND,RSLRSL,RSSRSS,
      RSRS,IDCS,RDSRDS,RDLRDL,VDCD,RDRD
FLIST SТОРС=NС,NN,NZ,NV,/NС,/NN,/NZ,/NV,МС,MN,MZ,MV,/МС,/MN,/MZ,/MV,
      IС,IN,IZ,IV,/IС,/IN,/IZ,/IV,SETNC,SETNN,SETNZ,SETNV,
      УТОМ,MTON,SЕТМ,SETN,MCN,NСМ,CLRM,CLRN,INVM,CLRNC,CLRNN,CLRNZ,CLRNV
FLIST MNSA=U,IRA,МР
FLIST MODNM=М0,М1,М2,М3,М4,М5,М6,М7,М8,М9,М10,М11,М12,М13,М14,SР,С,RR,
      RRR,SPRADR,СТТ,ACL,ACR,YCL,YCR,РСС,РССС,CTL,CTR,SVFA,PROCNC,MREZ
FLIST DSRC=MODGN,PROCN,CNT,PHYSPG,ARBOPC,MULRZ1,MULRZ2,СОМА,SHIFT,ОРС,
      LOS,PROM
FLIST RTIME=RТ
FLIST WTIME=WТ
FLIST YDST=MODGN,PROCN,CNT,PHYSPG,ARBOPC,MUL1,MUL2,ADRREG,PSHIFT,CCLR,BTRCLR
FLIST SHF=CICL,LOG,ARIPH,EMULF
FLIST ARBI=CCRD,CCWR,DCRD,DCWR,FЕТСН,DRD,DWR,RDMWR,BTRWR,BTRRD,BICLR,BIRD
FLIST CYSTR=NТ3,NТ4,NТ5,NТ6,NТ7,NТ8,NТ9,NТ10
FLIST BRA=RG0,RG1,RG2,RG3
FLIST ARA=RG0,RG1,RG2,RG3
FLIST YDEV=PHYSAD,RADRR,PSMEM,МРМЕМ,SТОРМ0,SТОРМ1
FLIST YDEVT=ECBTAG
FLIST DDEV=ВВ,MODB,CLRCD,STATUS,РРМЕМ0,РРМЕМ1
FLIST YDTIM=CTIME
FLIST FFCNT=LOGGRP,MULGRP,ADDGRP,SЕТС,CLRRCB,SETRCB,CLRJMP,SETJMP,
      SETEI,CLREI,CLRTR0,SETTR0,CLRTR1,SETTR1,CLRCT,CLRCTT,CLRTKK,SЕТТКК,
      STRTLD,СНТКК,SETHLT,CLRINT,CLRRUN,LDCPMP,PRGINT,EXTINT,SETNR,SETER
FLIST MPADR=ADRB1,ADRB2,ADRB3,ADRB4,DАТАВ1,DАТАВ2,DАТАВ3,DАТАВ4,
      DАТАВ5,DАТАВ6,DАТАВ7,DАТАВ8,INFB1,INFB2,FМР,FСР
FLIST COND=YES,NORMB,RNDB,OVRIB,BNB,OVRFTB,DRG,EMLRG,RСВ,СВ,CEMLRG,
      СТ,TR1,INTSTP,RUN,NMLRDY,INT,FULMEM,ARBRDY,СРМР,IR15,ТККВ
;
;СПИСОК ОШИБОЧНЫХ КОМБИНАЦИЙ ПОЛЕЙ
;---------------------------------
;
;ШИНА D:
;-------
;
;ИСТОЧНИКИ: DSRC
;           CSM-WЕМ
;           ЕСА-WRA
;           DDEV-WRD
;
СНЕСК DSRC+CSM-WЕМ
СНЕСК DSRC+ЕСА-WRA
СНЕСК DSRC+DDEV-WRD
СНЕСК CSM-WЕМ+ЕСА-WRA
СНЕСК CSM-WЕМ+DDEV-WRD
СНЕСК ЕСА-WRA+DDEV-WRD
;
;ШИНА У:
;-------
;
;ИСТОЧНИКИ: YDEVT-WRB
;           ALU
;           ЕСВ-WRB
;           YDEV-WRY
;           YDTIM+RTIME
;
СНЕСК YDEVT-WRB+ALU
СНЕСК YDEVT-WRB+ЕСВ-WRB
СНЕСК YDEVT-WRB+YDEV-WRY
СНЕСК YDEVT-WRB+YDTIM+RTIME
СНЕСК ALU+ЕСВ-WRB
СНЕСК ALU+YDEV-WRY
СНЕСК ALU+YDTIM+RTIME
СНЕСК ЕСВ-WRB+YDEV-WRY
СНЕСК ЕСВ-WRB+YDTIM+RTIME
СНЕСК YDEV-WRY+YDTIM+RTIME
;
;
;     ============================================
;     МАКРОСЫ ДЛЯ ОБ'ЕДИНЕНИЯ МЕЛКИХ ТЕСТОВ В ОДИН
;     ============================================
;
;ВАРИАНТ ДЛЯ ОДНОГО БОЛЬШОГО
MACRO J CONT
MACRO S CONT
;ВАРИАНТ ДЛЯ ОТДЕЛЬНЫХ ТЕСТОВ
;MACRO J CJP
;MACRO S CJS
;
;     ==================
;     МАКРОСЫ ДЛЯ КОМАНД
;     ==================
;
MACRO МА CSM,MNSA=IRA,ALUS=DQ,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
MACRO MAWF CSM,MNSA=МР,MODNM=SР,ALUS=DZ,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
MACRO ARF CSM,MNSA=МР,MODNM=SР,ALUS=DZ,FUNC=SUBS,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
MACRO SSPRG ЕСВ,WRB,BRA=RG3
MACRO PHAW YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
MACRO PHAR YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DRD
MACRO RСА DSRC=СОМА,ALUS=DZ,ALUD=Q
MACRO WА МАР=РЕ,COND=ARBRDY,IСС
MACRO SPRG ЕСВ,BRA=RG3,CSM,WЕМ,MNSA=МР,MODNM=SР
MACRO АС CSM,MNSA=МР,MODNM=С,ALUS=DQ,FUNC=ADD,ALUD=Q
MACRO TRSH DSRC=SHIFT,MPS,PSHF=SН0,SHF=LOG
MACRO R МАР=РЕ,COND=RСВ
MACRO М МАР=МЕ,COND=ТККВ,DDEV=CLRCD,WRD,ISE
MACRO MED МАР=МЕ,COND=ТККВ,LЕТС,ISE
MACRO ML МАР=МЕ,DDEV=CLRCD,WRD,ISE
MACRO МЕ МАР=МЕ,LЕТС
MACRO MI МАР=МЕ,COND=ТККВ,DDEV=CLRCD,WRD
MACRO TODR1 ECB,WRB,BRA=RG1,ECA,ARA=RG1
MACRO TODR2 ECB,WRB,BRA=RG2,ECA,ARA=RG2
MACRO TODR3 ECB,WRB,BRA=RG3,ECA,ARA=RG3
MACRO TOYR1 ECA,WRA,ARA=RG1,ECB,BRA=RG1
MACRO TOYR2 ECA,WRA,ARA=RG2,ECB,BRA=RG2
MACRO TOYR3 ECA,WRA,ARA=RG3,ECB,BRA=RG3
;
;     ==================
;     МАКРОСЫ ДЛЯ ТЕСТОВ
;     ==================
;
MACRO TN DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=EXPN,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=0
MACRO Т DSRC=PROM,ALUS=DZ,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=0
MACRO TIK ALUS=ZВ,RВ=MANT,Н,CI,ALUD=В,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=3
MACRO TIK3 ALUS=ZВ,RВ=WR3,Н,CI,ALUD=В,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=3
MACRO CLRTYP ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=INTR,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=1
MACRO ТУРЕ ALUS=ZВ,RВ=INTR,Н,CI,ALUD=В,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=1
MACRO С3 ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=WR3,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=3
;
;
*FULL LIST
OCT:PROG B;
;
;     РАСПРЕДЕЛЕНИЕ РЕГИСТРОВ БОПП ДЛЯ ТЕСТОВ:
;
;    АДРЕСА РЕГИСТРОВ БОПП:
;    0   1   2   3   4   5   6   7   8   9   А   В   С   D   Е   F
;  I-------------------------------I--------------------------------I
;  I   I   I   I   I          ДОПОЛНИТЕЛЬНАЯ  ИНФОРМАЦИЯ            I
;  I-------------------------------I--------------------------------I
;
;  0 РГ.БОПП: НОМЕР ТЕСТА
;  1 РГ.БОПП: ТИП ПРОВЕРКИ В ТЕСТЕ, ЕСЛИ ИХ НЕСКОЛЬКО; МЛ.БАЙТ РГ.INTR
;  2 РГ.БОПП: ТИП ОБРАЩЕНИЯ К БОПП:
;             00 - ЦИКЛ;
;             FF - ПРИЗНАК ОШИБКИ;
;             ХХ = "ЗАПРОС" = ТИП ПРОВЕРКИ (РГ.INTR).
;  3 РГ.БОПП: НОМЕР ЦИКЛА, МЛ.БАЙТ РГ.MANT
;
EXTERNAL INITST,ERRTST,ERRINF,ERRINH,ERRINQ,OUT8/F,RD8/F,ERR8/F
EXTERNAL RD8/В,OUTC/F,RD4/7,OUT4/7
;
;     =============
;     Б О И  ДАННЫХ
;     =============
;
БОИ6:ENTRY
;===== ЗАПИСЬ CONST ИЗ ПЗУ В RG1 БОИ ДАННЫХ, ЧТЕНИЕ, ЗАПИСЬ В 8-15 РГ.БОПП
;
CJP А=PSBOI6,МАР=РЕ
PSBOI6:CONT А=Н6,%T%
CJS А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В RG1 БОИ ДАННЫХ
CBOI6:CONT A=CAAA,DSRC=PROM,ECA,WRA,ARA=RG1
;ЧИТАЕМ В РГ.WR6 МПС, ПИШЕМ В 8-15 РГ.БОПП
CJS А=OUT8/F,МАР=РЕ,ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=WR6
CJP А=CBOI6,МАР=РЕ,%TIK%
;
;
БОИ7:ENTRY
;===== ЗАПИСЬ РАЗНЫХ CONST В RG0-3 БОИ ДАННЫХ, ЧТЕНИЕ, СРАВНЕНИЕ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 0,1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ДАННЫХ
;
CJP А=PSBOI7,МАР=РЕ
PSBOI7:CONT А=Н7,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РЕГИСТРЫ МПС И В RG0-3
OCTCKL:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ALU,ECB,WRB,BRA=RG0
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=DADR,ALU,ECB,WRB,BRA=RG1
CONT A=C555,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=HALF,ALU,ECB,WRB,BRA=RG2
CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE,ALU,ECB,WRB,BRA=RG3
;TYPE = 0 - RG0, ЧИТАЕМ В РГ.Y МПС
CBOI7:CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1 - RG1
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=DАDR,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=HALF,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=BYTE,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOI7,МАР=РЕ,%TIK%
;
;
БОИ8:ENTRY
;===== ПИШЕМ 0/FFFF В RG0-3 БОИ ДАННЫХ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 0,1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ДАННЫХ
;
CJP А=PSBOI8,МАР=РЕ
PSBOI8:CONT А=Н8,%T%
%S% А=INITST,МАР=РЕ
;CONST (0) - В А
CONT A=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;ПИШЕМ
CBOI8:CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG0
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG1
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG2
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A,ALU,ECB,WRB,BRA=RG3
;ЧИТАЕМ, СРАВНИВАЕМ
;0 - RG0
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1 - RG1
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=А,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
CONT ALUS=ZA,RA=А,FUNC=EXNOR,Н,ALUD=В,RB=A
%J% А=CBOI8,МАР=РЕ,%TIK%
;
;
БОИ9:ENTRY
;===== ПИШЕМ РАЗНЫЕ ПЕРЕМЕННЫЕ В RG0-3 БОИ ДАННЫХ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   TYPE = 0,1,2,3 - СООТВЕТСТВУЕТ НОМЕРУ РЕГИСТРА БОИ ДАННЫХ
;
CJP А=PSBOI9,МАР=РЕ
PSBOI9:CONT А=Н9,%T%
%S% А=INITST,МАР=РЕ
;НАЧАЛЬНЫЕ CONST ИЗ ПЗУ - В РЕГИСТРЫ МПС
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=DADR
CONT A=C555,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=HALF
CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=BYTE
;ПЕРЕМЕННЫЕ - В RG0-3
CBOI9:CONT ALUS=ZA,RA=A,FUNC=ADD,H,CI,ALUD=B,RB=A,ALU,ECB,WRB,BRA=RG0
CONT ALUS=ZA,RA=DADR,FUNC=ADD,H,CI,ALUD=B,RB=DADR,ALU,ECB,WRB,BRA=RG1
CONT ALUS=ZA,RA=HALF,FUNC=ADD,H,CI,ALUD=B,RB=HALF,ALU,ECB,WRB,BRA=RG2
CONT ALUS=ZA,RA=BYTE,FUNC=ADD,H,CI,ALUD=B,RB=BYTE,ALU,ECB,WRB,BRA=RG3
;TYPE = 0 - RG0, ЧИТАЕМ В РГ.Y МПС
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1 - RG1
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=DАDR,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;2 - RG2
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=HALF,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;3 - RG3
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=BYTE,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOI9,МАР=РЕ,%TIK%
;
;
БОИ91:ENTRY
;===== ЗАПИСЬ CONST В ЧЕРЕЗ RG0-3 БОИ ДАННЫХ В АИСП., ЧТЕНИЕ, СРАВНЕНИЕ
;   ПРИ ОШ. 8-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ; ЛИБО 8-11 = ЧТО ПИСАЛИ, 12-15 = ЧИТАЕМ
;   ОШ. = 0-5 - СООТВЕТСТВУЮТ РАЗНЫМ ПЕРЕСЫЛКАМ ЧЕРЕЗ БОИ ДАННЫХ
;
CJP А=PSBI91,МАР=РЕ
PSBI91:CONT А=Н91,%T%
%S% А=INITST,МАР=РЕ
;CONST ИЗ ПЗУ - В РЕГИСТР A МПС, В RG1, В АИСП.
CBOI91:CONT A=CAAA,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ECA,WRA,ARA=RG1,ECB
>,BRA=RG1,YDST=ADRREG
;00: ЧИТАЕМ RG1
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: ЧИТАЕМ АИСП. ЧЕРЕЗ RG2
CONT YDEV=RADRR,ECB,WRB,BRA=RG2,ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02: ЧИТАЕМ RG2
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;CONST ИЗ ПЗУ - В РЕГИСТР A МПС, В RG0, В АИСП.
CONT A=C555,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,ECA,WRA,ARA=RG0,ECB
>,BRA=RG0,YDST=ADRREG
;03: ЧИТАЕМ RG0
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;04: ЧИТАЕМ АИСП. ЧЕРЕЗ RG3
CONT YDEV=RADRR,ECB,WRB,BRA=RG3,ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;05: ЧИТАЕМ RG3
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT A=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=CBOI91,МАР=РЕ,%TIK%
;
;     ====================
;     Б О И  ДАННЫХ И ТЕГА
;     ====================
;
БОИA:ENTRY
;===== ЗАПИСЬ CONST В RG0 БОИ ДАННЫХ (ПО А) И RG3 БОИ ТЕГА (ЧЕРЕЗ МПС)
;   А - ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ОШИБКИ: 0 - БОИ ДАННЫХ, 8-15 РГ.БОПП = ПРОЧИТАННОМУ ИЗ RG0 БОИ ДАННЫХ;
;           1 - БОИ ТЕГА, 15 РГ. БОПП = ПРОЧИТАННОМУ ИЗ RG3 БОИ ТЕГА
;
CJP А=PSBOIA,МАР=РЕ
PSBOIA:CONT А=НA,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ, ПИШЕМ В РГ.А, RG0 ДАННЫХ (ПО А) И RG3 ТЕГА (ЧЕРЕЗ МПС)
CONT А=СААА,DSRC=PROM,ЕСА,WRA,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=А,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG3
;0: ЧИТАЕМ БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIA:CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1: ЧИТАЕМ БОИ ТЕГА ЧЕРЕЗ СДВИГАТЕЛЬ, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIA,МАР=РЕ,%TIK%
;
;
БОИB:ENTRY
;===== ЗАПИСЬ CONST В RG3 БОИ ДАННЫХ И ТЕГА (В ОБА - ПО КАНАЛУ В ЧЕРЕЗ МПС)
;   А - ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗУЛЬТАТ СРАВНЕНИЯ;
;   ОШИБКИ: 0 - БОИ ДАННЫХ, 8-15 РГ.БОПП = ПРОЧИТАННОМУ ИЗ RG0 БОИ ДАННЫХ;
;           1 - БОИ ТЕГА, 15 РГ. БОПП = ПРОЧИТАННОМУ ИЗ RG3 БОИ ТЕГА
;
CJP А=PSBOIB,МАР=РЕ
PSBOIB:CONT А=НB,%T%
%S% А=INITST,МАР=РЕ
;ЧИТАЕМ CONST ИЗ ПЗУ, ПИШЕМ В РГ.А, RG3 ДАННЫХ И ТЕГА (ЧЕРЕЗ МПС)
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,ALU,YDEVT=ECBTAG,ЕСВ,WRB,BRA=RG3
;0: ЧИТАЕМ БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIB:CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1: ЧИТАЕМ БОИ ТЕГА, СРАВНИВАЕМ
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=А,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIB,МАР=РЕ,%TIK%
;
;
БОИC:ENTRY
;===== ЗАПИСЬ РАЗНЫХ CONST ВО ВСЕ РЕГИСТРЫ БОИ ДАННЫХ И ТЕГА
;   Y - ПРОЧИТАННОЕ; КОД ОШИБКИ - В СКОБКАХ, ПРИ ОШ. 8-15 РГ.БОПП = ПРОЧИТАННОЕ.
;   WR1 - ЗАПИСАННОЕ В RG0 ДАННЫХ (0), RG3 ТЕГА (6)
;   WR2 - RG1 ДАННЫХ (1), RG2 ТЕГА (5)
;   WR3 - RG2 ДАННЫХ (2), RG1 ТЕГА (4)
;   WR4 - RG3 ДАННЫХ (3) (В RG0 ТЕГА НЕ ПИШЕМ!)
;
CJP А=PSBOIC,МАР=РЕ
PSBOIC:CONT А=НC,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ ИЗ ПЗУ В БОИ ДАННЫХ ПО А, В РГ. МПС, ЧЕРЕЗ МПС - В БОИ ТЕГА
;В WR1, RG0 ДАННЫХ, RG3 ТЕГА
CONT А=СААА,DSRC=PROM,ЕСА,WRA,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=WR1,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG3
;В WR2, RG1 ДАННЫХ, RG2 ТЕГА
CONT А=С555,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=WR2,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG2
;В WR3, RG2 ДАННЫХ, RG1 ТЕГА
CONT А=МН,DSRC=PROM,ЕСА,WRA,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=WR3,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG1
;В WR4, RG3 ДАННЫХ
CONT А=MNH,DSRC=PROM,ЕСА,WRA,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=WR4
;INTR=0: ЧИТАЕМ RG0 БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIC:CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR1,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1: RG1 ДАННЫХ
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR2,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2: RG2 ДАННЫХ
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR3,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=3: RG3 ДАННЫХ
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=WR4,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4: RG1 БОИ ТЕГА, ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR3,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5: RG2 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR2,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=6: RG3 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR1,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIC,МАР=РЕ,%TIK%
;
;
БOИD:ENTRY
;===== ПИШЕМ В РЕГИСТРЫ БОИ ДАННЫХ И ТЕГА РАЗНЫЕ ЧИСЛА, ЧИТАЕМ, СРАВНИВАЕМ
;   ПИШЕМ: WR4 - В RG0 ДАННЫХ, ОШИБКИ: 00
;          WR3 - В RG1 ДАННЫХ, ТЕГА:   01    04
;          WR2 - В RG2 ДАННЫХ, ТЕГА:   02    05
;          WR1 - В RG3 ДАННЫХ, ТЕГА:   03    06
;
CJP А=PSBOID,МАР=РЕ
PSBOID:CONT А=HD,%T%
%S% А=INITST,МАР=РЕ
;УСТАНАВЛИВАЕМ НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ПЕРЕМЕННЫХ (ЧИТАЕМ ИЗ ПЗУ)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR4
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR2
CONT А=MNH,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;ПИШЕМ ИЗ МПС В БОИ ДАННЫХ И В БОИ ТЕГА: RG0
CBOID:CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR4,ALU,ЕСВ,WRB,BRA=RG0
;В RG1
CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR3,ALU,YDEVT=ECBTAG,BRA=RG1,ЕСВ,WRB
;В RG2
CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR2,ALU,YDEVT=ECBTAG,BRA=RG2,ЕСВ,WRB
;В RG3
CONT ALUS=ZВ,Н,CI,ALUD=В,RВ=WR1,ALU,YDEVT=ECBTAG,BRA=RG3,ЕСВ,WRB
;0: ЧИТАЕМ RG0 БОИ ДАННЫХ, СРАВНИВАЕМ
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR4,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;1: RG1 ДАННЫХ
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR3,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;2: RG2 ДАННЫХ
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR2,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;3: RG3 ДАННЫХ
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=WR1,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;4: ПРОВЕРЯЕМ RG1 БОИ ТЕГА, ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=Y,RB=WR3,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;5: RG2 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=WR2,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;6: RG3 ТЕГА
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=WR1,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOID,МАР=РЕ,%TIK%
;
;
БOИE:ENTRY
;===== ПИШЕМ 0/F В РЕГИСТРЫ БОИ ДАННЫХ И ТЕГА, ЧИТАЕМ, СРАВНИВАЕМ
;   ПИШЕМ: В RG0 ДАННЫХ, ОШИБКИ: 00
;          В RG1 ДАННЫХ, ТЕГА:   01    04
;          В RG2 ДАННЫХ, ТЕГА:   02    05
;          В RG3 ДАННЫХ, ТЕГА:   03    06
;
CJP А=PSBOIE,МАР=РЕ
PSBOIE:CONT А=HE,%T%
%S% А=INITST,МАР=РЕ
;ПИШЕМ ИЗ ПЗУ В БОИ ДАННЫХ ПО А, В РГ. МПС, ЧЕРЕЗ МПС - В БОИ ТЕГА
;FFFF - B RG0 ДАННЫХ, 0 - B RG3 ТЕГА
CONT А=СFFF,DSRC=PROM,ЕСА,WRA,ARA=RG0,ALUS=DZ,FUNC=EXNOR,Н,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG3
;РАЗДЕЛЯЕМ ЗАПИСЬ В РЕГИСТРЫ ПУСТЫМИ КОМАНДАМИ
CONT
;0 - В RG1 ДАННЫХ, FFFF - B RG1 ТЕГА
CONT А=ZER,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,FUNC=EXNOR,Н,ALU
>,YDEVT=ECBTAG,WRB,BRA=RG1
CONT
;FFFF - B RG2 ДАННЫХ, RG2 ТЕГА
CONT А=ZER,DSRC=PROM,ALUS=DZ,FUNC=EXNOR,H,ALU,ECB,YDEVT=ECBTAG,WRB,BRA=RG2
CONT
;0 - B RG3 ДАННЫХ
CONT А=CFFF,DSRC=PROM,ALUS=DZ,FUNC=EXNOR,Н,ALU,ECB,WRB,BRA=RG3
;INTR=0: ЧИТАЕМ RG0 БОИ ДАННЫХ, СРАВНИВАЕМ
CBOIE:CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG0,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1: RG1 ДАННЫХ
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2: RG2 ДАННЫХ
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG2,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=3: RG3 ДАННЫХ
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ЕСА,ARA=RG3,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=У,RВ=A,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4: RG1 БОИ ТЕГА, ЧИТАЕМ ЧЕРЕЗ СДВИГАТЕЛЬ
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT YDEVT=ECBTAG,BRA=RG1,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5: RG2 ТЕГА
CONT A=CFFF,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT YDEVT=ECBTAG,BRA=RG2,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=6: RG3 ТЕГА
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT YDEVT=ECBTAG,BRA=RG3,%TRSH%,ALUS=DZ,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q
CONT А=МВ,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CBOIE,МАР=РЕ,%TIK%
;
;     =====================
;     СТАНДАРТИЗАТОР КОМАНД
;     =====================
;
СТНДF:ENTRY
;===== КОМАНДНОЕ СЛОВО ЗАДАЕМ В БОПП;  АК,КОП,МОД.ПО АДР.IRA - ПИШЕМ В БОПП
;   ВХОДНАЯ ИНФОРМАЦИЯ В РГ.БОПП ПРИ ЗАПУСКЕ ТЕСТА:
;   8-15 - КОМАНДНОЕ СЛОВО;
;   7 = 0 - НОВЫЙ РЕЖИМ; НЕ РАВЕН 0 - РЕЖИМ ЭМУЛЯЦИИ;
;   ВЫХОДНАЯ ИНФОРМАЦИЯ В РГ.БОПП:             ИСПОЛЬЗУЕМЫЕ РЕГИСТРЫ:
;   4     - МОДИФИКАТОР ПО АДРЕСУ IRA ЛК       А   - КОМАНДНОЕ СЛОВО
;   5     - КОП ЛК                             У   - АК ЛК;   WR3 - АК ПК
;   6-9   - АИСП.ЛК                            WR5 - КОП ЛК;  WR2 - КОП ПК
;   10    - МОДИФИКАТОР ПО АДРЕСУ IRA ПК       WR4 - ИР ЛК;   WR1 - ИР ПК
;   11    - КОП ПК                             В 0-Й МОДИФИКАТОР ЗАПИСАНО 0!
;   12-15 - АИСП.ПК
;
CJP А=PSSTF,МАР=РЕ
PSSTF:CONT А=НF,%T%
CJS А=INITST,МАР=РЕ
;0 - РГ/ТГ, 5 - В РНГ, FFFFFFFF - В М0
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
CONT А=С5,DSRC=PROM,ALUS=DZ,ALU,YDST=MODGN
CONT А=ZER,DSRC=PROM,ALUS=DZ,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ 7 РГ.БОПП (ПРИЗНАК РЕЖИМА); ИДЕМ НА П/П ЧТЕНИЯ КОМАНДНОГО СЛОВА ИЗ БОПП
CJS А=RD8/F,МАР=РЕ,YDEV=МРМЕМ,IОМР,MPADR=7,DSRC=SHIFT,MPS,PSHF=SН0-56,SHF=LOG
>,ALUS=DZ,Н,ALUD=В,RВ=WR2,CEN
CJP А=ССF,МАР=РЕ,COND=СТ,SТОРС=NZ,FFCNT=SETNR
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;БП,БПТЗ = 1  (19,27 РАЗРЯДЫ РР)
;CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;3 - В АИСП, RG3 TEГА (ПРИЗНАК КОМАНДЫ + РЭ)
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,ЕСВ,WRB,BRA=RG3
;ФИЗ.АДРЕС - В RG0
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAWF:CJP А=WAWF,%WА%
;ЧИТАЕМ ПО ТОМУ ЖЕ АДРЕСУ
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WARF:CJP А=WARF,%WА%
;
;ЗАПОМИНАЕМ КОМ.СЛОВО
ССF:CONT ALUS=ZА,RА=WR6,Н,ALUD=В,RВ=А
;
;ПИШЕМ КОМАНДНОЕ СЛОВО ИЗ РЕГИСТРА МПС В БОИ В РЕГИСТР КОМАНД
CICTF:CONT ALUS=ZA,RA=A,H,ALU,ЕСВ,WRB,BRA=RG1
CONT ALUS=ZA,RA=A,H,ALUD=B,RB=WR1,FFCNT=CLRTKK
;ЧИТАЕМ КОП, ПИШЕМ В 5 РГ.БОПП
CJP А=NRF,МАР=РЕ,COND=СТ,SТОРС=NZ,DSRC=ОРС,ALUS=DZ,ALUD=В,RВ=WR5,ALU
>,YDEV=МРМЕМ,WRY,IОМР,MPADR=5
;
;ВЫДЕЛЯЕМ ИР ЛК, ПИШЕМ В АИСП, ПИШЕМ В ОЗУ МОД.ПО U, ЧИТАЕМ ПО IRA
;ДЛЯ РЭ СДВИГАЕМ КОМ.СЛОВО ВЛЕВО НА 4 РАЗРЯДА АРИФМЕТИЧЕСКИ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4,SHF=ARIPH
;СДВИГАЕМ IRA ЛК В МЛ.РАЗРЯДЫ
NRF:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60
>,SHF=LOG
;ПИШЕМ В АИСП
CONT ALUS=ZА,RА=WR2,ALU,YDST=ADRREG
;ПИШЕМ ТО ЖЕ В ОЗУ МОД. ПО U
;ЕСЛИ IRA=0, ЗАПИСИ НЕ Д.БЫТЬ, ЧИТАЕТСЯ 0, Т.Е. ТО ЧТО ЗАПИСАНО В М0 РАНЬШЕ
CONT ALUS=ZА,RА=WR2,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ ПО IRA НОМЕР ИНДЕКС-РЕГИСТРА, ПИШЕМ В БОПП
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=WR4,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=4
;
;ЧИТАЕМ АК ЛК, ПИШЕМ В 6-9 РГ.БОПП; МЛ.БАЙТЫ - В СТАРШИХ ПО НОМЕРУ РЕГИСТРАХ!
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=DZ,Н,ALUD=ВА,RА=У,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=9
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=8
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=7
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=ZА,RА=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=6
;
;ЧИТАЕМ КОП ПК, ПИШЕМ В 11 РГ.БОПП
CONT FFCNT=SЕТТКК
CJP А=NRMF,МАР=РЕ,COND=СТ,SТОРС=NZ
>,DSRC=ОРС,ALUS=DZ,ALUD=В,RВ=WR2,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=11
;
;ВЫДЕЛЯЕМ ИР ПК, ПИШЕМ В АИСП, ПИШЕМ В ОЗУ МОД.ПО U, ЧИТАЕМ ПО IRA
;ДЛЯ РЭ СДВИГАЕМ КОМ.СЛОВО ВПРАВО НА 8 (Т.К.НА 4 ВЛЕВО В РЭ УЖЕ СДВИНУТО!)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
;СДВИГАЕМ IRA ПК В МЛ.РАЗРЯДЫ
NRMF:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR1,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0+28
>,SHF=LOG
CONT А=HF,DSRC=PROM,ALUS=DА,RА=WR1,FUNC=AND,ALUD=В,RВ=WR1,ALU,YDST=ADRREG
;ПИШЕМ ТО ЖЕ В ОЗУ МОД. ПО U
CONT ALUS=ZА,RА=WR1,ALU,CSM,WЕМ,MNSA=U
;ЧИТАЕМ ПО IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=WR1,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=10
;
;ЧИТАЕМ АК ПК, ПИШЕМ В 12-15 РГ.БОПП
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=WR3
CONT ALUS=DZ,ALUD=ВА,RА=WR3,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=15
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=14
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=DZ,ALUD=ВА,RА=WR6,RВ=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=13
>,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
CONT ALUS=ZА,RА=WR6,ALU,YDEV=МРМЕМ,WRY,IОМР,MPADR=12
CJP А=CICTF,МАР=РЕ,%TIK%
;
;
СТНД10:ENTRY
;===== КОМАНДНОЕ СЛОВО = "0", НОВЫЙ РЕЖИМ
;   РГ.У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ = 12-15 РГ.БОПП; A - ЧТО Д.БЫТЬ = 8-11 РГ.БОПП
;   Q - РЕЗ-Т СРАВНЕНИЯ, DADR - ЗАПИСАННОЕ В ИР0; ВУТЕ - МАСКА НА БАЙТ.
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК), 12-15 РГ.БОПП = ПРОЧИТАННОМУ АК (Д.Б.0)
;           01 (05): - " -  КОП ЛК (ПК), 15 РГ.БОПП = ПРОЧИТАННОМУ КОП (Д.Б.0)
;           02 (06): ЕСТЬ ПРИЗНАК ИР15, 8-15 РГ.БОПП НЕ ИЗМЕНЯЮТСЯ
;           03 (07): - " -  МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК); (Д.Б.CONST=AAAA)
;
CJP А=PSST10,МАР=РЕ
PSST10:CONT А=Н10,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В RG1 БОИ ДАННЫХ, В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,ЕСВ,WRB,BRA=RG1
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС DADR, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;
;00: ЧИTАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CST10:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=CLRTKK
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
;П/У НА ВЫДАЧУ РЕГИСТРОВ В БОПП, ЕСЛИ ОШИБКА
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ ОТСУТСТВИЕ ПРИЗНАКА ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=DADR,Н,ALUD=В,RВ=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ЧИТАЕМ ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ПРОВЕРЯЕМ ОТСУТСТВИЕ ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=DADR,Н,ALUD=В,RВ=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CST10,МАР=РЕ,%TIK%
;
;
СТНД11:ENTRY
;===== КОМАНДНОЕ СЛОВО = FF...FF, НОВЫЙ РЕЖИМ
;   РГ.У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ, DADR - ЗАПИСАННОЕ В ИР15
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК)
;           01 (05): - " -  КОП ЛК (ПК)
;           02 (06): НЕТ ПРИЗНАКА ИР15 НА УСЛОВИЯХ
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК)
;
CJP А=PSST11,МАР=РЕ
PSST11:CONT А=Н11,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALUD=В,RВ=HALF,ALU,YDST=CNT
;CONST - В РГ.МПС DADR, В 15 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA), РНГ - КАКОЙ ЕСТЬ
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;FF...FF - В RG1 БОИ
CONT А=CFFF,DSRC=PROM,ЕСА,WRA,ARA=RG1
;
;00: ЧИТАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT FFCNT=CLRTKK
CST11:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT A=MH,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П (МАСКА И СРАВНЕНИЕ)
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT A=MB,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ЧИТАЕМ ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT A=MH,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT A=MB,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q
CONT A=MB,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=AB,RА=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CST11,МАР=РЕ,%TIK%
;
;
СТНД12:ENTRY
;===== КОМАНДНОЕ СЛОВО = 0...0F...F (ИЛИ F...F0...0), НОВЫЙ РЕЖИМ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК = 0 (АК = F..F)
;           01 (05): - " -  КОП = 0 (КОП = FF)
;           02 (06): ЕСТЬ ИР15 НА УСЛОВИЯХ У КОМАНДЫ = 0 (НЕТ ИР15 У F...F)
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0 (IRA = F);
;  ВУТЕ - МАСКА НА 8 Р.; HALF - МАСКА НА 32 Р.; DADR - М0; РС - ЗАПИСАННОЕ В SР
;
CJP А=PSST12,МАР=РЕ
PSST12:CONT А=Н12,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ И ТКК (НАЧИНАЕМ С ЛЕВОЙ КОМАНДЫ)
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС DADR, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA = 0)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ДРУГУЮ CONST - В РГ.МПС РС И ПО АДРЕСУ IRA = F
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;ЧИТАЕМ CONST 00...FF - В РГ.HALF
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;ПИШЕМ КОМАНДНОЕ СЛОВО (0...0F...F) - В RG1, В РГ.А
CONT А=МН,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=А
;
;ПРОВЕРЯЕМ КОМАНДУ (0...0):
;00: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CST12:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ ОТСУТСТВИЕ ПРИЗНАКА ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ЧИТАЕМ КОМАНДУ (F...F): АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT FFCNT=СНТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=BYTE,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ПРОВЕРЯЕМ ПРИЗНАК ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA = F
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT ALUS=AB,RA=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО, НЕ МЕНЯЯ ТКК (НАЧИНАЕМ С ДРУГОЙ ПОЛОВИНЫ)
CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,ЕСВ,WRB,BRA=RG1
%J% А=CST12,МАР=РЕ,%TIK%
;
;
СТНД13:ENTRY
;===== КОМАНДНОЕ СЛОВО = 00...00/FF...FF, НОВЫЙ РЕЖИМ
;   A - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 01 (05): ЧИТАЕМ АК = 0 ЛК (ПК)
;           02 (06): - " -  КОП = 0 ЛК (ПК)
;           03 (07): ЕСТЬ ИР15 НА УСЛОВИЯХ У ЛЕВОЙ КОМАНДЫ = 0 (ПК)
;           04 (08): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0 У ЛК (ПК)
;           09 (0D): ЧИТАЕМ АК = F...F ЛК (ПК)
;           0A (0E): - " -  КОП = FF ЛК (ПК)
;           0B (0F): НЕТ ИР15 НА УСЛОВИЯХ У ЛЕВОЙ КОМАНДЫ = F..F (ПК)
;           0C (10): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = F У ЛК (ПК)
;  ВУТЕ - МАСКА НА 8 Р.; HALF - МАСКА НА 32 Р.; DADR - М0; РС - ЗАПИСАННОЕ В SР
;
CJP А=PSST13,МАР=РЕ
PSST13:CONT А=Н13,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ И ТКК (НАЧИНАЕМ С ЛЕВОЙ КОМАНДЫ)
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС DADR, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA = 0)
CONT А=СFFF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ДРУГУЮ CONST - В РГ.МПС РС И ПО АДРЕСУ IRA = F
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;ПИШЕМ КОМАНДНОЕ СЛОВО (00...00) - В RG1, В РГ.А
CONT А=ZER,DSRC=PROM,ЕСА,WRA,ARA=RG1,ALUS=DZ,Н,ALUD=В,RВ=А
;
CST13:PUSH A=1,MAP=PE,%CLRTYP%
;ПРОВЕРЯЕМ КОМАНДУ (0...0):
;01,05: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02,06: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;03,07: ПРОВЕРЯЕМ ОТСУТСТВИЕ ПРИЗНАКА ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;04,08: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA = 0
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
RFCT FFCNT=CHTKK
;
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО (FF...FF)
PUSH A=1,MAP=PE,ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,ЕСВ,WRB,BRA=RG1
;09,0D: ЧИТАЕМ КОМАНДУ (F...F): АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=HALF,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;0A,0E: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=BYTE,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;0B,0F: ПРОВЕРЯЕМ ПРИЗНАК ИР15 НА УСЛОВИЯХ
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;0C,10: ЧИТАЕМ ПО АДРЕСУ IRA = F
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT ALUS=AB,RA=Y,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
RFCT FFCNT=CHTKK
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=ZА,RА=А,FUNC=EXNOR,Н,ALUD=В,RВ=А,ALU,ЕСВ,WRB,BRA=RG1
%J% А=CST13,МАР=РЕ,%TIK%
;
;
СТНД14:ENTRY
;===== КОМАНДНОЕ СЛОВО = 0...0Х...Х (КОП,АК,ИР ПК - ПЕРЕМЕННЫЕ), НОВЫЙ РЕЖИМ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (03): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;           01 (04): - " -  КОП ЛК (ПК ОСНОВНОГО ФОРМАТА)
;           02 (05): - " -  АК ЛК (ПК ОСНОВНОГО ФОРМАТА)
;               06:  - " -  КОП ПК ДОПОЛНИТЕЛЬНОГО ФОРМАТА
;               07:  - " -  АК ПК ДОПОЛНИТЕЛЬНОГО ФОРМАТА
;   ВУТЕ - МАСКА НА БАЙТ; HALF - НА 32Р.;DADR - НА 4Р.;РССОРУ - М0; РС - ПО IRA
;   WR6  - АК; WR5 - КОП; WR4 - ИР; WR2,A - РАБОЧИЕ
;   WR3 - "СБОРНАЯ" ПРАВАЯ КОМАНДА, ЗАПИСАННАЯ В СТ.РАЗРЯДАХ
;
CJP А=PSST14,МАР=РЕ
PSST14:CONT А=Н14,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ И ТКК: НОВЫЙ РЕЖИМ, ЛЕВАЯ КОМАНДА
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА (ДЛЯ IRA) - В DADR
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;МАСКУ НА 32 РАЗРЯДА - В РГ. HALF
CONT А=МН,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ПЕРЕМЕННЫМ ДЛЯ ЗАПИСИ В 0 МОДИФ. И ПО АДРЕСУ IRA
CONT А=MWN,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ
CONT А=В11,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;ЗАДАЕМ НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ПЕРЕМЕННЫМ ДЛЯ АК,КОП,ИР (В СТАРШИХ РАЗРЯДАХ)
;АДРЕС КОМАНДЫ - WR6 (В 44-64 РАЗРЯДАХ)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,DSRC=SHIFT,MPS,PSHF=SН0-44,SHF=LOG
;КОП - В WR5 (В 57-64 РАЗРЯДАХ)
CONT ALUS=DZ,Н,ALUD=ВА,RА=DADR,RВ=WR5,ALU,DSRC=SHIFT,MPS,PSHF=SН0-56,SHF=LOG
;ИР - В WR4 (В 61-64 РАЗРЯДАХ)
CONT А=В62,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR4,СЕМ
;
;"СОБИРАЕМ" ПРАВУЮ КОМАНДУ
;АК - СДВИГ ВПРАВО НА 8 - В WR3
CST14:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SН0+8,SHF=LOG
;+ КОП
CONT ALUS=АВ,RА=WR5,RВ=WR3,FUNC=OR,Н,ALUD=В
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SН0+4,SHF=LOG
;+ ИР, СДВИГАЕМ НА МЕСТО ПК, ПИШЕМ В RG1 ПО КАНАЛУ А
CONT ALUS=АВ,RА=WR4,RВ=WR3,FUNC=OR,Н,ALUD=В,ALU,DSRC=SHIFT,MPS,PSHF=SН0+32
>,SHF=LOG,ЕСА,WRA,ARA=RG1
;ПИШЕМ В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA ЛК)
CONT ALUS=ZВ,RВ=РССОРУ,Н,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ПИШЕМ В МОДИФИКАТОР ПО IRA ПК (IRA СДВИГАЕМ В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП.)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR4,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=ZА,RА=WR2,ALU,YDST=ADRREG
;ЕСЛИ N МОДИФ.=0, ЗАПИСИ НЕ ПРОИСХОДИТ
CONT ALUS=ZВ,RВ=РС,Н,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
;
;ЧИТАЕМ ЛЕВУЮ КОМАНДУ (0...0)
;00: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (М0)
CONT ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ЧИТАЕМ ПРАВУЮ КОМАНДУ (Х...Х)
CONT FFCNT=SЕТТКК
;03: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA, СРАВНИВАЕМ С ЗАПИСАННЫМ ПО U
;ЕСЛИ IRA=0, ЗАПИСИ НЕ БЫЛО, НАДО СРАВНИВАТЬ С РССОРУ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;П/У, ЕСЛИ N МОДИФИКАТОРА (IRA) НЕ РАВЕН 0 (РГ.М СУСС СООТВЕТСТВУЕТ IRA B WR6)
CJP А=IRA0,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РС,H,ALUD=B,RB=A
;СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=A
IRA0:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04,06: К О П ОСНОВНОГО (04) ИЛИ ДОПОЛНИТЕЛЬНОГО (06) ФОРМАТА
;ПРОВЕРЯЕМ КОП НА ДОП. ФОРМАТ (3F)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR5,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+56,SHF=LOG
CONT A=H3F,DSRC=PROM,ALUS=DA,RA=WR2,FUNC=EXOR,ALUD=Q,CEM
CJP A=DFC14,MAP=PE,COND=CT,STOPC=/MZ
;ЕСЛИ ДОП.ФОРМАТ, КОП = СТАРШИЕ 8 РАЗРЯДОВ АДРЕСА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR4,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+56,SHF=LOG
;УВЕЛИЧИВАЕМ TYPE НА 2, ЧТОБ ОТЛИЧИТЬ ЭТОТ СЛУЧАЙ
CONT %TYPE%
CONT %TYPE%
DFC14:CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ЗАПИСАННЫЙ АК СДВИГАЕМ АРИФМЕТИЧЕСКИ В МЛ. РАЗРЯДЫ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR6,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
;05,07: АДРЕС КОМАНДЫ (32Р.) ОСНОВНОГО (05) ИЛИ ДОПОЛНИТЕЛЬНОГО (07) ФОРМАТА
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CJP A=DFA14,MAP=PE,COND=CT,STOPC=/MZ,ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
;ЕСЛИ ДОП.ФОРМАТ, СРАВНИВАЕМ ТОЛЬКО МЛАДШИЕ 12 РАЗРЯДОВ
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
DFA14:CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ИЗМЕНЯЕМ АК,КОП,ИР; ТКК = ЛК
CONT А=В45,DSRC=PROM,ALUS=DА,RА=WR6,Н,ALUD=В,RВ=WR6,FFCNT=CLRTKK
CONT А=В57,DSRC=PROM,ALUS=DА,RА=WR5,Н,ALUD=В,RВ=WR5
CONT А=В61,DSRC=PROM,ALUS=DА,RА=WR4,Н,ALUD=В,RВ=WR4,СЕМ
%J% А=CST14,МАР=РЕ,%TIK%
;
;
СТНД15:ENTRY
;===== ПЕРЕМЕННОЕ КОМАНДНОЕ СЛОВО В НОВОМ РЕЖИМЕ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ВУТЕ   - МАСКА НА 8 РАЗРЯДОВ
;   DADR   - МАСКА НА 4 РАЗРЯДА, ЧИСЛО ДЛЯ ЗАПИСИ В М0
;   РС     - МАСКА НА 20 РАЗРЯДОВ
;   WR3    - КОМАНДНОЕ СЛОВО
;   РССОРУ - ЧИСЛО ДЛЯ ЗАПИСИ ПО АДРЕСУ IRA
;   WR1    - ДОБАВКА К КОМ.СЛОВУ
;   WR2    - РАБОЧИЙ РЕГИСТР
;
;    64  61 60   53 52       33 32  29 28    21 20        1
;   I-----I--------I-----------I------I--------I-----------I
;   IИР ЛKI КОП ЛК I   АК ЛК   IИР ЛК I КОП ЛК I   АК ЛК   I
;   I-----I--------I-----------I------I--------I-----------I
;
CJP А=PSST15,МАР=РЕ
PSST15:CONT А=Н15,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В 0-Й МОДИФИКАТОР
CONT А=HF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;МАСКУ НА 20 РАЗРЯДОВ - В РГ. РС
CONT А=MADR,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В RG1
CONT А=NTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ
;ФОРМИРУЕМ CONST: ИР ЛК = КОП ЛК = АК ЛК = 2; ИР ПК = КОП ПК = АК ПК = 1
;(ЧТОБ ШАГ ИЗМЕНЕНИЯ ЛК И ПК БЫЛ РАЗНЫЙ)
CONT А=В29,DSRC=PROM,ALUS=DZ,Н,CI,ALUD=В,RВ=WR1
CONT А=В21,DSRC=PROM,ALUS=DА,RА=WR1,Н,ALUD=В,RВ=WR2
CONT ALUS=DА,FUNC=OR,Н,ALUD=ВА,RА=WR2,RВ=WR1,ALU,DSRC=SHIFT,MPS,PSHF=SН0-33
>,SHF=LOG,FFCNT=SЕТТКК
;
;ЧИТАЕМ ПРАВУЮ КОМАНДУ
;00: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CST15:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+28
>,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MZ15,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MZ15:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
;КОП ПК - В МЛ.РАЗРЯДЫ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+20,SHF=LOG
;ПРОВЕРЯЕМ КОП НА ДОП. ФОРМАТ (3F)
CONT A=H3F,DSRC=PROM,ALUS=DA,RA=A,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,ALUD=Q,CEM
CJP A=DFC15R,MAP=PE,COND=CT,STOPC=/MZ
;ЕСЛИ ДОП.ФОРМАТ, КОП = 13-20 РАЗРЯДАМ АДРЕСА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+12,SHF=LOG
;ЧИТАЕМ, СРАВНИВАЕМ
DFC15R:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR 32 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-44,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ ДОП.ФОРМАТ, ОСТАВЛЯЕМ У АК ТОЛЬКО 12 РАЗРЯДОВ
CJP A=DFA15R,MAP=PE,COND=CT,STOPC=/MZ,ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
DFA15R:CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ЧИТАЕМ ЛЕВУЮ КОМАНДУ
CONT FFCNT=CLRTKK
;03: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MDZ15,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MDZ15:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+52,SHF=LOG
;ПРОВЕРЯЕМ КОП НА ДОП. ФОРМАТ (3F)
CONT A=H3F,DSRC=PROM,ALUS=DA,RA=A,FUNC=EXOR,ALUD=Q
CONT ALUS=AQ,RA=BYTE,FUNC=AND,ALUD=Q,CEM
CJP A=DFC15L,MAP=PE,COND=CT,STOPC=/MZ
;ЕСЛИ ДОП.ФОРМАТ, КОП = 13-20 РАЗРЯДАМ АДРЕСА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=LOG
;ЧИТАЕМ, СРАВНИВАЕМ
DFC15L:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=BYTE,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR БЕЗ Н
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-12,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ ДОП.ФОРМАТ, ОСТАВЛЯЕМ У АК ТОЛЬКО 12 РАЗРЯДОВ
CJP A=DFA15R,MAP=PE,COND=CT,STOPC=/MZ,ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CONT A=MPP,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;МЕНЯЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=АВ,RА=WR1,RВ=WR3,Н,ALUD=В,ALU,ЕСВ,WRB,BRA=RG1,FFCNT=SЕТТКК
%J% А=CST15,МАР=РЕ,%TIK%
;
;
СТНД25:ENTRY
;===== КОМАНДНОЕ СЛОВО C "БЕГУЩЕЙ" ЕДИНИЦЕЙ В НОВОМ РЕЖИМЕ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ВУТЕ   - МАСКА НА 8 РАЗРЯДОВ
;   DADR   - МАСКА НА 4 РАЗРЯДА, ЧИСЛО ДЛЯ ЗАПИСИ В М0
;   РС     - МАСКА НА 20 РАЗРЯДОВ
;   WR3    - КОМАНДНОЕ СЛОВО
;   РССОРУ - ЧИСЛО ДЛЯ ЗАПИСИ ПО АДРЕСУ IRA
;   WR2    - РАБОЧИЙ РЕГИСТР
;
;    64  61 60   53 52       33 32  29 28    21 20        1
;   I-----I--------I-----------I------I--------I-----------I
;   IИР ЛKI КОП ЛК I   АК ЛК   IИР ЛК I КОП ЛК I   АК ЛК   I
;   I-----I--------I-----------I------I--------I-----------I
;
CJP А=PSST25,МАР=РЕ
PSST25:CONT А=Н25,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ/ТГ
CONT ALUS=DZ,FUNC=AND,Н,ALU,YDST=CNT
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В 0-Й МОДИФИКАТОР
CONT А=HF,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;МАСКУ НА 20 РАЗРЯДОВ - В РГ. РС
CONT А=MADR,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В RG1
CONT А=B1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,FFCNT=SЕТТКК
;
;ПРАВАЯ КОМАНДА:
;00: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CST25:CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+28
>,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MZ25,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MZ25:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
;КОП ПК - В МЛ.РАЗРЯДЫ; ЧИТАЕМ, СРАВНИВАЕМ
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+20,SHF=LOG
;У "БЕГУЩЕЙ" ЕДИНИЦЫ ДОП. ФОРМАТА (3F) НЕ М.БЫТЬ, НЕ ПРОВЕРЯЕМ
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR 32 РАЗРЯДА
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-44,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ЧИТАЕМ ЛЕВУЮ КОМАНДУ
CONT FFCNT=CLRTKK
;03: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=WR2,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=WR2,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CJP А=MDZ25,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZА,RА=РССОРУ,ALUD=В,RВ=A
;ЕСЛИ N МОД. = 0, ЗАПИСИ НЕ Д.БЫТЬ, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CONT ALUS=ZА,RА=DADR,ALUD=В,RВ=A
MDZ25:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ (НА ДОП. ФОРМАТ (3F) НЕ ПРОВЕРЯЕМ)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+52,SHF=LOG
CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=BYTE,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINF,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ВЫЧИСЛЯЕМ АДРЕС КОМАНДЫ, РАЗМНОЖАЕМ 20 РАЗРЯД, СРАВНИВАЕМ
;СДВИГАЕМ ЛОГ. ВЛЕВО, ЗАТЕМ АРИФМ.ВПРАВО НА 44, EOR БЕЗ Н
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-12,SHF=LOG
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+44,SHF=ARIPH
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СДВИГАЕМ ЦИКЛИЧЕСКИ КОМАНДНОЕ СЛОВО
CONT ALUS=DZ,H,ALUD=ВA,RA=WR3,RB=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SH0-1,SHF=CICL
>,ЕСA,WRA,ARA=RG1,FFCNT=SЕТТКК
%J% А=CST25,МАР=РЕ,%TIK%
;
;   ==========================================================
;   ПРИ ЗАПУСКЕ ТЕСТОВ СТАНДАРТИЗАТОРА В РЭ РЭ УСТАНАВЛИВАЕТСЯ
;       ПОЛЕМ FFCNT ИЛИ ПРИ ЧТЕНИИ КОМАНДЫ ИЗ ПАМЯТИ !!!!!
;   ==========================================================
;          ПРИ ЧТЕНИИ КОП В КОРОТКОАДРЕСНЫХ КОМАНДАХ
;      7-Й РАЗРЯД КОП НЕ ОБНУЛЯЕТСЯ В СТАНДАРТИЗАТОРЕ !!!!!
;   ==========================================================
;
СТНД16:ENTRY
;===== РАЗНЫЕ ФОРМАТЫ КОМАНДНОГО СЛОВА В РЕЖИМЕ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ВУТЕ - МАСКА НА БАЙТ
;   WR1  - 7000 - ДОПОЛНЕНИЕ К КОРОТКОМУ АДРЕСУ
;   HALF - МАСКА НА 15 Р.
;   РС   - М0
;   DADR - С0 (ДЛЯ СРАВНЕНИЯ КОП)
;
;ДЛИННОАДРЕСНЫЙ КОП:
;   64 63 60 59 57 56(1) 52 51       37 36 33 32(1) 28 27       13 12  1
;   I--I-----I-----I--------I-----------I-----I--------I-----------I-----I
;   IИPI/////IИР ЛKI КОП ЛК I   АК ЛК   IИР ПKI КОП ПК I   АК ПК   I/////I
;   I--I-----I-----I--------I-----------I-----I--------I-----------I-----I
;   64 63 60 59 57 56(0) 49 48       37 36 33 32(0) 25 24       13 12  1
;КОРОТКОАДРЕСНЫЙ КОП:
;
CJP А=PSST16,МАР=РЕ
PSST16:CONT А=Н16,%T%
%S% А=INITST,МАР=РЕ
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС РС, В 0 МОДИФ.
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА КОРОТКИЙ АДРЕС С ДОБАВЛ."1" (7000) - В WR1
CONT А=САК,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;3 - В АИСП, RG3 TEGA
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;>,ЕСА,WRA,ARA=RG3
;ФИЗ.АДРЕС - В RG0
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW16:CJP А=WAW16,МАР=РЕ,COND=ARBRDY,IСС
;ЧИТАЕМ ПО ТОМУ ЖЕ АДРЕСУ
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR16:CJP А=WAR16,МАР=РЕ,COND=ARBRDY,IСС
;
;===== ДЛИННОАДРЕСНЫЙ КОП
;КОМ.СЛОВО: "1" В 56 И В 32 РАЗРЯДЕ
CST16:CONT А=В56,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6
CONT А=В32,DSRC=PROM,ALUS=DА,RА=WR6,FUNC=OR,Н,ALUD=В,RВ=WR6,ALU,ЕСВ,WRB
>,BRA=RG1,FFCNT=CLRTKK
;
;INTR=0; ЛК: АДРЕС КОМАНДЫ (ЕСЛИ 32 Р.=0, 16-32 РАЗРЯДЫ ЗАПОЛНЯЮТСЯ 0)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;INTR=1; К О П: СРАВНИВАЕМ С 1 В 8 РАЗРЯДЕ
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT А=В8,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=АB,RА=У,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=2; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;INTR=3; ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА = 0)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=4; К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT А=В8,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RА=A,RB=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=5; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ФОРМИРУЕМ КОМ.СЛОВО С 1 В 56,55; 32,31; 1-15 РАЗРЯДАХ
CONT ALUS=DА,FUNC=OR,Н,ALUD=ВА,RА=WR6,RВ=WR6,ALU,DSRC=SHIFT,MPS,PSHF=SН0+1
>,SHF=LOG,FFCNT=CLRTKK
CONT ALUS=АВ,RА=HALF,RВ=WR6,FUNC=OR,Н,ALUD=В,ALU,ЕСВ,WRB,BRA=RG1
;ЧИТАЕМ "1" В 7-8 РАЗРЯДАХ ДЛЯ СРАВНЕНИЯ КОП'А (С0)
CONT А=НС0,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;
;INTR=6; ЧИТАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=7; К О П: СРАВНИВАЕМ С 1 В 8,7 РАЗРЯДАХ
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=8; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;INTR=9; ПК: АДРЕС КОМАНДЫ (32 РАЗРЯДА, 1-3 Р. = 1, ОСТАЛЬНЫЕ "1" - МИМО)
CONT A=C7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=У,RB=A,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=A; К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=B; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;===== КОРОТКОАДРЕСНЫЙ КОП
;КОМ.СЛОВО: "1" В 55 И В 31 РАЗРЯДЕ
CONT А=В55,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR6,FFCNT=CLRTKK
CONT А=В31,DSRC=PROM,ALUS=DА,RА=WR6,Н,ALUD=В,RВ=WR6,ALU,ЕСВ,WRB,BRA=RG1
;
;INTR=C; ЛК: АДРЕС КОМАНДЫ = 7000, 13-15 РАЗРЯДЫ = 1
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=WR1,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=D; К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕТСЯ В СТАНДАРТИЗАТОРЕ !!!!!
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT A=B7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=E; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;INTR=F; ПК: АДРЕС КОМАНДЫ, 13-15 РАЗРЯДЫ = 1
CONT ALUS=ZA,RA=WR1,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=10; К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕТСЯ В СТАНДАРТИЗАТОРЕ !!!!!
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT A=B7,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT ALUS=AB,RA=A,RB=Y,FUNC=EXOR,H,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;INTR=11; ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CST16,МАР=РЕ,%TIK%
;
СТНД17:ENTRY
;===== КОМАНДНОЕ СЛОВО = "0",  РЕЖИМ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК)
;           01 (05): - " -  КОП ЛК (ПК)
;           02 (06): ЕСТЬ ПРИЗНАК ИР15 В ЛК (ПК)
;           03 (07): СИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;   ВУТЕ - МАСКА НА БАЙТ, РС - ЗАПИСАННОЕ В М0
;
CJP А=PSST17,МАР=РЕ
PSST17:CONT А=Н17,%T%
%S% А=INITST,МАР=РЕ
;БП,БПТЗ = 1
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;CONST - В РГ.МПС РС, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
;0 - В RG1 (КОМАНДНОЕ СЛОВО)
CONT ALUS=ZА,FUNC=AND,Н,ALU,ЕСВ,WRB,BRA=RG1,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;МАТ.АДРЕС - В АИСП, РЭ (1,2Р.=1) - В ТЕГ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WА17:CJP А=WА17,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR17:CJP А=WAR17,МАР=РЕ,COND=ARBRDY,IСС
;
;00: ЧИТАЕМ ЛК: АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CST17:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=CLRTKK
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ ОТСУТСТВИЕ ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ПРОВЕРЯЕМ ПК: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА)
CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ПРИЗНАК ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=АB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CST17,МАР=РЕ,%TIK%
;
;
СТНД18:ENTRY
;===== КОМАНДНОЕ СЛОВО = FF...FF, РЕЖИМ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК ЛК (ПК)
;           01 (05): - " -  КОП ЛК (ПК)
;           02 (06): НЕТ ПРИЗНАКА ИР15 В ЛК (ПК)
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК)
;  ВУТЕ - МАСКА НА БАЙТ; HALF - НА 15Р.; DADR = F8 - НА КОРОТКИЙ КОП; РС - SР
;
CJS А=PSST18,МАР=РЕ
PSST18:CONT А=Н18,%T%
%S% А=INITST,МАР=РЕ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
;МАСКУ НА 15 РАЗР.- В РГ.HALF
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА КОРОТКИЙ КОП (F8) - DADR
CONT А=HF8,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR
;CONST - В РГ.МПС РС, В 15 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA)
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ, FF...FF - В RG1 БОИ
CONT А=CFFF,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW18:CJP А=WAW18,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR18:CJP А=WAR18,МАР=РЕ,COND=ARBRDY,IСС
;
;00: ПРОВЕРЯЕМ ЛК: ЧИТАЕМ АДРЕС КОМАНДЫ (32Р.), 15 РАЗРЯДОВ = 7FFF, ОСТАЛЬН.= 0
CST18:CONT A=M15,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=CLRTKK
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П (МАСКА И СРАВНЕНИЕ С F8)
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;03: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ПРОВЕРЯЕМ ПК: ЧИТАЕМ АДРЕС КОМАНДЫ (32 РАЗРЯДА), МЛ.15 = 1...1
CONT A=M15,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=SЕТТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ ПО АДРЕСУ IRA
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CST18,МАР=РЕ,%TIK%
;
;
СТНД19:ENTRY
;===== КОМАНДНОЕ СЛОВО = 0...0(ЛК) F...F(ПК) И НАОБОРОТ; РЕЖИМ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (04): ЧИТАЕМ АК КОМАНДЫ 0 (F...F)
;           01 (05): - " -  КОП КОМАНДЫ 0 ((F...F)
;           02 (06): НЕ ТОТ ПРИЗНАК ИР15 В КОМАНДЕ 0 (F...F)
;           03 (07): ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA КОМАНДЫ 0 (F...F)
;   ВУТЕ - МАСКА НА БАЙТ; WR1 = F8 - НА КОРОТКИЙ КОП; HALF - НА 15Р.;
;   РС - ЗАПИСАННОЕ В М0; РССОРУ - В ИР15; WR3 - ТЕКУЩЕЕ КОМАНДНОЕ СЛОВО
;
CJP А=PSST19,МАР=РЕ
PSST19:CONT А=Н19,%T%
%S% А=INITST,МАР=РЕ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=CLRTKK
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА КОРОТКИЙ КОП В РЭ (F8) - В РГ. WR1
CONT А=С7,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,Н,ALUD=В,RВ=WR1
;CONST - В РГ.МПС РС, В 0 МОДИФ. (КОТОРЫЙ ПО АДРЕСУ IRA ЛК)
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ДРУГУЮ CONST - В РГ.МПС РССОРУ И ПО АДРЕСУ IRA ПК
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,ALU,CSM,WЕМ,MNSA=МР,MODNM=SР
;ПИШЕМ КОМАНДНОЕ СЛОВО (0...0F...F) - В RG1, ВОДОРАЗДЕЛ - МЕЖДУ 37,36 РАЗРЯДАМИ
CONT А=В37,DSRC=PROM,ALUS=DZ,FUNC=SUBS,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
;
;ФОРМИРУЕМ РЭ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ, МАСКУ НА АДРЕС - В HALF
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW19:CJP А=WAW19,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR19:CJP А=WAR19,МАР=РЕ,COND=ARBRDY,IСС
;
;00: ЧИТАЕМ КОМАНДУ 0...0: АДРЕС КОМАНДЫ (32 РАЗРЯДА = 0)
CST19:CONT A=ZER,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A
CONT DSRC=СОМА,ALUS=DZ,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,%ТУРЕ%
;03: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA (М0)
CONT ALUS=ZA,RA=PC,H,ALUD=B,RB=A
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;04: ПК, F...F: АДРЕС КОМАНДЫ (32 РАЗРЯДА, ИЗ КОТОРЫХ 1-15 = F...F)
CONT A=M15,DSRC=PROM,ALUS=DZ,H,ALUD=B,RB=A,FFCNT=СНТКК
CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: К О П, СРАВНИВАЕМ С F8:
CONT DSRC=ОРС,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=ZA,RA=WR1,H,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;06: ИР15
CJS А=ERRTST,МАР=РЕ,COND=IR15,IСС,%ТУРЕ%
;07: ЧИТАЕМ МОДИФИКАТОР ПО АДРЕСУ IRA (SР)
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
CONT ALUS=ZA,RA=PCCOPY,H,ALUD=B,RB=A
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;ИНВЕРТИРУЕМ КОМАНДНОЕ СЛОВО, НЕ МЕНЯЯ ТКК; ИДЕМ НА ЦИКЛ
CONT ALUS=ZА,RА=WR3,FUNC=EXNOR,Н,ALUD=В,RВ=WR3,ALU,ЕСВ,WRB,BRA=RG1
%J% А=CST19,МАР=РЕ,%TIK%
;
;
СТНД1А:ENTRY
;===== ПЕРЕМЕННОЕ КОМАНДНОЕ СЛОВО В РЕЖИМЕ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (03): ЧИТАЕМ АК ЛК (ПК)
;           01 (04): - " -  КОП ЛК (ПК)
;           02 (05): - " -  МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;   ВУТЕ - МАСКА НА БАЙТ; HALF - НА 13-15Р.; DADR - НА 4Р. И М0; РС - НА 15Р.
;   WR3 - КОМАНДНОЕ СЛОВО; РССОРУ - IRA; WR1 - ДОБАВКА К КОМ.СЛОВУ; WR2 - РАБ.
;
CJP А=PSST1A,МАР=РЕ
PSST1A:CONT А=Н1А,%T%
%S% А=INITST,МАР=РЕ
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=SETER
;СТАРЫЙ ВАРИАНТ: ЧИТАЕМ КОМ.СЛОВО ИЗ ПАМЯТИ С ПРИЗНАКОМ РЭ
;CONT А=С3,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,YDEVT=ECBTAG,WRB,BRA=RG3
;CONT YDEV=PHYSAD,ЕСВ,WRB,BRA=RG0,ARBI=DWR
;WAW:CJP А=WAW,МАР=РЕ,COND=ARBRDY,IСС
;CONT YDEV=PHYSAD,ARBI=FЕТСН
;WAR:CJP А=WAR,МАР=РЕ,COND=ARBRDY,IСС
;
;МАСКУ НА 13-15 РАЗР.ДЛЯ АК - В HALF
CONT А=САК,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;МАСКУ НА 15 РАЗР.- В РС
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В М0
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В КОМ.СЛОВО
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ЕСА,WRA,ARA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ
;ЧИТАЕМ CONST С "1" В РАЗНЫХ РАЗРЯДАХ (ДОБАВКА К КОМ.СЛОВУ)
CONT А=СОРС,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR1,FFCNT=SЕТТКК
;
;00: ПК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CST1A:CONT А=В32,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ
;И СЛЕДУЮЩИЙ
CONT А=В31,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ, П/У, ЕСЛИ СТ.РАЗРЯД КОП = 1
CJP А=LONG,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+12,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONG,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONG:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕМ !!!!!
;КОП ПК - В МЛ.РАЗРЯДЫ; ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RОРСR,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+24,SHF=LOG
;КОП = 5 РАЗРЯДОВ, ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП (ТАМ ДЛИННЫЙ АДРЕС)
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=ROPCR,MAP=PE
;КОП = 8 РАЗРЯДОВ, ЧТО С 7 РАЗРЯДОМ ?
;OPCB7:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
ROPCR:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+32,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0 РАНЬШЕ
CJP А=MD0,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MD0:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;03: ЛК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CONT А=В56,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ,FFCNT=CLRTKK
;И СЛЕДУЮЩИЙ
CONT А=В55,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ
CJP А=LONGR,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+36,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONGR,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONGR:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=РС,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ, ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RDOPCL,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+48,SHF=LOG
;ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП, ЕСЛИ ОН КОРОТКИЙ
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=RDOPCL,MAP=PE
;УБИРАЕМ 7-Й РАЗРЯД КОП
;ОРСLNG:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
RDOPCL:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
;СНАЧАЛА УБИРАЕМ "ДЫРУ" В ПОРЯДКЕ (СДВИГ АРИФМ.ВЛЕВО НА 4)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4,SHF=ARIPH
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CJP А=MDR0,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MDR0:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;МЕНЯЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=АВ,RА=WR1,RВ=WR3,Н,ALUD=В,ALU,ЕСВ,WRB,BRA=RG1,FFCNT=SЕТТКК
%J% А=CST1A,МАР=РЕ,%TIK%
;
;
СТНД1B:ENTRY
;===== КОМАНДНОЕ СЛОВО С "БЕГУЩЕЙ" ЕДИНИЦЕЙ В РЕЖИМЕ ЭМУЛЯЦИИ
;   А - ЧТО Д.БЫТЬ, У - ПРОЧИТАННАЯ ИНФОРМАЦИЯ, Q - РЕЗ-Т СРАВНЕНИЯ
;   8-11 РГ.БОПП - ЧТО Д.БЫТЬ, 12-15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;   ОШИБКИ: 00 (03): ЧИТАЕМ АК ЛК (ПК)
;           01 (04): - " -  КОП ЛК (ПК)
;           02 (05): - " -  МОДИФИКАТОР ПО АДРЕСУ IRA ЛК (ПК);
;   ВУТЕ - МАСКА НА БАЙТ; HALF - НА 13-15Р.; DADR - НА 4Р. И М0; РС - НА 15Р.
;   WR3 - КОМАНДНОЕ СЛОВО; РССОРУ - IRA; WR2 - РАБОЧИЙ.
;
CJP А=PSST1B,МАР=РЕ
PSST1B:CONT А=Н1B,%T%
%S% А=INITST,МАР=РЕ
;ФОРМИРУЕМ РЕЖИМ ЭМУЛЯЦИИ В ЦП С ПОМОЩЬЮ РГ/ТГ ПРИЗНАКОВ
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT,FFCNT=SETER
;МАСКУ НА 13-15 РАЗР.ДЛЯ АК - В HALF
CONT А=САК,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=HALF
;МАСКУ НА 15 РАЗР.- В РС
CONT А=М15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС
;МАСКУ НА БАЙТ - В РГ.МПС ВУТЕ, В РНГ
CONT А=МВ,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=MODGN
;МАСКУ НА 4 РАЗРЯДА - В РГ. DADR, В М0
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;НАЧАЛЬНЫЕ ЗНАЧЕНИЯ ДЛЯ КОМАНДНОГО СЛОВА - В WR3, В КОМ.СЛОВО
CONT А=B1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=WR3,ЕСА,WRA,ARA=RG1
;ДЛЯ ЗАПИСИ В МОДИФИКАТОР
CONT А=CTS,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РССОРУ,FFCNT=SЕТТКК
;
;00: ПК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CST1B:CONT А=В32,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ
;И СЛЕДУЮЩИЙ
CONT А=В31,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ, П/У, ЕСЛИ СТ.РАЗРЯД КОП = 1
CJP А=LONGB,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+12,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONGB,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONGB:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: К О П, 7-Й РАЗРЯД НЕ ОБНУЛЯЕМ !!!!!
;КОП ПК - В МЛ.РАЗРЯДЫ; ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RОРСRB,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+24,SHF=LOG
;КОП = 5 РАЗРЯДОВ, ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП (ТАМ ДЛИННЫЙ АДРЕС)
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=ROPCRB,MAP=PE
;КОП = 8 РАЗРЯДОВ, ЧТО С 7 РАЗРЯДОМ ?
;OPCB7B:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
ROPCRB:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+32,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0 РАНЬШЕ
CJP А=MD0B,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MD0B:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;03: ЛК, АДРЕС КОМАНДЫ
;"ВЫЧИСЛЯЕМ" АК ПО КОМ.СЛОВУ; СНАЧАЛА ПРОВЕРЯЕМ СТ.РАЗРЯД КОП
CONT А=В56,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,СЕМ,FFCNT=CLRTKK
;И СЛЕДУЮЩИЙ
CONT А=В55,DSRC=PROM,ALUS=DА,RА=WR3,FUNC=AND,Н,CEN
;АДРЕС КОМАНДЫ - В МЛ.РАЗРЯДЫ
CJP А=LONGRB,МАР=РЕ,COND=СТ,SТОРС=/MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+36,SHF=LOG
;СТ.РАЗРЯД КОП=0, АДРЕС = КОРОТКИЙ, НАДО ВПРАВЛЯТЬ 13-15 РАЗРЯДЫ
;ПОДСТАВЛЯЕМ 1, ЕСЛИ 7 РАЗРЯД КОП = 1
CJP А=LONGRB,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=АВ,RА=HALF,RВ=A,FUNC=OR,ALUD=В
;ИНАЧЕ ПОДСТАВЛЯЕМ 0
CONT ALUS=АВ,RА=HALF,RВ=A,FUNC=EXOR,ALUD=В
;СРАВНИВАЕМ 15 РАЗРЯДОВ
LONGRB:CONT DSRC=СОМА,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=РС,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04: К О П
;КОП ЛК - В МЛ.РАЗРЯДЫ, ПРОВЕРЯЕМ, ДЛИННЫЙ ЛИ КОП
CJP А=RDLB,МАР=РЕ,COND=СТ,SТОРС=MZ
>,ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+48,SHF=LOG
;ОБНУЛЯЕМ МЛ.3 РАЗРЯДА КОП, ЕСЛИ ОН КОРОТКИЙ
CONT А=С7,DSRC=PROM,ALUS=DА,RА=A,FUNC=NOTRS,ALUD=В,RВ=A
;CJP A=RDLB,MAP=PE
;УБИРАЕМ 7-Й РАЗРЯД КОП
;LNGB:CONT A=B7,DSRC=PROM,ALUS=DA,RA=A,FUNC=NOTRS,ALUD=B,RB=A
;ЧИТАЕМ, СРАВНИВАЕМ
RDLB:CONT DSRC=ОРС,ALUS=DZ,ALUD=B,RB=Y
CONT АLUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT ALUS=АQ,RА=ВУТЕ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ЧИТАЕМ ПО АДРЕСУ IRA
;СДВИГАЕМ ИР В МЛ.РАЗРЯДЫ, ПИШЕМ В АИСП, ПИШЕМ ПО U В ОЗУ МОДИФ., ЧИТАЕМ ПО IRA
;СНАЧАЛА УБИРАЕМ "ДЫРУ" В ПОРЯДКЕ (СДВИГ АРИФМ.ВЛЕВО НА 4)
CONT ALUS=DZ,Н,ALUD=ВА,RА=WR3,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0-4,SHF=ARIPH
CONT ALUS=DZ,Н,ALUD=ВА,RА=A,RВ=A,ALU,DSRC=SHIFT,MPS,PSHF=SН0+60,SHF=LOG
CONT ALUS=АВ,RА=DADR,RВ=A,FUNC=AND,ALU,YDST=ADRREG,СЕМ
CONT ALUS=ZВ,RВ=РССОРУ,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=U
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=B,RB=Y
;ЕСЛИ N МОД. = 0, СРАВНИВАЕМ С ЗАПИСАННЫМ В М0
CJP А=MDR0B,МАР=РЕ,COND=СТ,SТОРС=/MZ,ALUS=ZA,RА=РССОРУ,H,ALUD=B,RB=A
CONT ALUS=ZA,RA=DADR,H,ALUD=B,RB=A
MDR0B:CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СДВИГАЕМ КОМАНДНОЕ СЛОВО
CONT ALUS=DZ,Н,ALUD=ВA,RA=WR3,RB=WR3,ALU,DSRC=SHIFT,MPS,PSHF=SH0-1,SHF=CICL
>,ЕСA,WRA,ARA=RG1,FFCNT=SЕТТКК
%J% А=CST1B,МАР=РЕ,%TIK%
;
;     =======================================
;     ОЗУ МОДИФИКАТОРОВ С БОИ  ( MNSA = IRA )
;     =======================================
;
МОД9:ENTRY
;===== ПИШЕМ ИЗ БОПП - В 8-Й МОДИФИКАТОР; АДРЕС МОД.= IRA, ЛК, В RG1(!)
;   ЧИТАЕМ 8-11 РГ.БОПП; ПИШЕМ РЕЗУЛЬТАТ - В 12-15 РГ.БОПП
;   РНГ - КАКОЙ ЕСТЬ! ЕСТЬ БОИ !
;
CJP А=PSMOD9,МАР=РЕ
PSMOD9:CONT А=Н9,%T%
CJS А=INITST,МАР=РЕ,FFCNT=SETNR
;ЧИТАЕМ ИЗ 8-11 РГ.БОПП
CMOD9:CJS А=RD8/В,МАР=РЕ
;КОМАНДНОЕ СЛОВО ИЗ ПЗУ - В RG1; IRA У ЛК = 8; ТКК = ЛК
CONT А=В64,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=CLRTKK
;ПИШЕМ В 8-Й МОДИФИКТОР
CONT ALUS=ZА,RА=WR6,ALU,CSM,WЕМ,MNSA=IRA
;ЧИТАЕМ, ПИШЕМ В БОПП
CJS А=OUTC/F,МАР=РЕ,CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=WR6
CJP А=CMOD9,МАР=РЕ,%TIK%
;
;
MOДF:ENTRY
;===== ПИШЕМ 0/F - В 4-Й МОДИФИКАТОР; АДРЕС МОДИФ.- B IRA, В RG1(!); ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMODF,МАР=РЕ
PSMODF:CONT А=HF,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;КОМАНДУ С НОМЕРОМ ИР = 4 В ПРАВОЙ КОМАНДЕ -> В РЕГИСТР КОМАНД, ТКК = ПК
CONT А=В31,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=SЕТТКК
;ЦИКЛ: ПИШЕМ В 4-Й МОДИФИКТОР
CMODF:CONT ALUS=ZА,RА=А,FUNC=EXNOR,ALUD=В,RВ=А,ALU,CSM,WЕМ,MNSA=IRA
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMODF,МАР=РЕ,%TIK%
;
;
МОД15:ENTRY
;===== ПИШЕМ ПЕРЕМЕННУЮ - ВО 2-Й МОД.; АДРЕС МОДИФ.- В RG1(!); ЧИТАЕМ
;   РГ.А - ЧТО ПИШЕМ; У - ЧТО ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ; РНГ - КАКОЙ ЕСТЬ!
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD15,МАР=РЕ
PSMD15:CONT А=Н15,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ.А
CONT ALUS=DZ,FUNC=AND,ALUD=В,RВ=А
;КОМАНДУ С НОМЕРОМ ИР = 2 В ПРАВОЙ КОМАНДЕ -> В РЕГИСТР КОМАНД, ТКК = ПК
CONT А=В30,DSRC=PROM,ЕСА,WRA,ARA=RG1,FFCNT=SЕТТКК
;ЦИКЛ: ПИШЕМ ВО 2-Й МОДИФИКТОР
CMOD15:CONT ALUS=ZВ,RВ=А,FUNC=ADD,CI,ALUD=В,ALU,CSM,WЕМ,MNSA=IRA
;ЧИТАЕМ, СРАВНИВАЕМ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
%J% А=CMOD15,МАР=РЕ,%TIK%
;
;
МОД19:ENTRY
;===== ПИШЕМ ИНВЕРТ.АДРЕС РГ. В МЛ.15 РГ.КАЖДОЙ ГРУППЫ;АДРЕС МОД.- В RG1, НР!
;   РС = N РЕГИСТРА ПК В КОМ.СЛОВЕ; А = ИНВЕРТИРОВАННЫЙ РС - ЧТО ЗАПИСАЛИ;
;   У - ЧТО ЧИТАЕМ; DADR - НОМЕР ГРУППЫ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD19,МАР=РЕ
PSMD19:CONT А=Н19,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN,FFCNT=SЕТТКК
;IRA = 1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT А=В29,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ПИШЕМ ИНВЕРТИР.КОМ.СЛОВО В РЕГИСТРЫ; АДРЕС - ИЗ РГ.КОМАНД
LС19:CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,CSM,WЕМ,MNSA=IRA
;УВЕЛИЧИВАЕМ N РЕГ., СРАВНИВАЕМ С IRA=17 ("1" В 33 РАЗРЯДЕ)
CONT А=В29,DSRC=PROM,ALUS=DА,RА=РС,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=LС19,МАР=РЕ,COND=СТ,SТОРС=/NZ
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МС19:PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;IRA = 1 РГ.
CONT А=В29,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ВЫЧИСЛЯЕМ ИНВЕРТИРОВАННЫЙ НОМЕР РЕГИСТРА
NNC19:CONT ALUS=ZА,RА=РС,FUNC=EXNOR,Н,ALUD=В,RВ=А
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ
;УВЕЛИЧИВАЕМ НОМЕР РЕГИСТРА
CONT А=В29,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU
>,ЕСВ,WRB,BRA=RG1
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=NNC19,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
%J% А=МС19,МАР=РЕ
;
;
МОД29:ENTRY
;===== ПИШЕМ ПЕРЕМЕННЫЙ КОД В МЛ.15 РГ.КАЖДОЙ ГРУППЫ;АДРЕС МОД.- В RG1,ПК,РЭ!!
;   РС = N РЕГИСТРА ПК В КОМ.СЛОВЕ; А = КОД, КОТОРЫЙ ПИШЕМ;
;   У - ЧТО ЧИТАЕМ; DADR - НОМЕР ГРУППЫ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD29,МАР=РЕ
PSMD29:CONT А=Н29,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN,FFCNT=SЕТТКК
;IRA = 1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT А=В33,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ПИШЕМ ПЕРЕМЕННЫЙ КОД ИЗ РГ.A; АДРЕС МОД.- B РГ.КОМАНД
LС29:CONT ALUS=ZА,RА=A,ALU,CSM,WЕМ,MNSA=IRA
;УВЕЛИЧИВАЕМ N РЕГ., СРАВНИВАЕМ С IRA=17 ("1" В 37 РАЗРЯДЕ)
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В37,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=LС29,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МC29:CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;IRA = 1 РГ.
CONT А=В33,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
NNC29:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ НОМЕР РЕГИСТРА
CONT А=В33,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU
>,ЕСВ,WRB,BRA=RG1
CONT А=В37,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,Н,CEN
CJP А=NNС29,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
%J% А=МС29,МАР=РЕ
;
;
МОД39:ENTRY
;===== ПИШЕМ ПЕРЕМЕННЫЙ КОД В МЛ.15 РГ.КАЖДОЙ ГРУППЫ;АДРЕС МОД.- В RG1,ЛК!!,РЭ
;   РС = N РЕГИСТРА ЛК В КОМ.СЛОВЕ; А = КОД, КОТОРЫЙ ПИШЕМ;
;   У - ЧТО ЧИТАЕМ; DADR - НОМЕР ГРУППЫ;
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD39,МАР=РЕ
PSMD39:CONT А=Н39,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN,FFCNT=CLRТКК
;IRA = 1 - В РС: НОМЕР РЕГИСТРА В ГРУППЕ
CONT А=В57,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ПИШЕМ ПЕРЕМЕННЫЙ КОД ИЗ РГ.A; АДРЕС МОД.- B РГ.КОМАНД
LС39:CONT ALUS=ZА,RА=A,ALU,CSM,WЕМ,MNSA=IRA
;УВЕЛИЧИВАЕМ N РЕГ., СРАВНИВАЕМ С IRA=8 (ЧТОБ "ОБОЙТИ" ДЫРУ В ПОРЯДКЕ)
CONT А=В57,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В60,DSRC=PROM,ALUS=DА,RА=РС,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В60,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CJP А=LС39,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
CONT А=В64,DSRC=PROM,ALUS=DА,RА=PC,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В64,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CJP A=LC39,MAP=PE,COND=CT,STOPC=NZ
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;ЧТЕНИЕ
;0 - В РГ.DADR (НОМЕР ГРУППЫ); ЦИКЛ ПО ГРУППАМ:
МC39:CONT A=ZER,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
PUSH А=31,МАР=РЕ,ALUS=DZ,FUNC=AND,ALUD=В,RВ=DADR,ALU,YDST=MODGN
;IRA = 1 РГ.
CONT А=В57,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
;ЧИТАЕМ ПЕРЕМЕННУЮ ИЗ ОЗУ МОД.,СРАВНИВАЕМ
NNC39:CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;УВЕЛИЧИВАЕМ НОМЕР РЕГИСТРА
CONT А=В57,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CONT А=В60,DSRC=PROM,ALUS=DА,RА=РС,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В60,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CJP А=NNС39,МАР=РЕ,COND=СТ,SТОРС=/NZ,ALUS=ZA,RA=A,FUNC=ADD,CI,ALUD=B,RB=A
CONT А=В64,DSRC=PROM,ALUS=DА,RА=PC,FUNC=AND,Н,ALUD=B,RB=Y
CONT А=В64,DSRC=PROM,ALUS=DА,RА=Y,FUNC=EXOR,Н,CEN
CONT А=В64,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,ЕСВ,WRB,BRA=RG1
CJP A=NNC39,MAP=PE,COND=CT,STOPC=NZ
;УВЕЛИЧИВАЕМ НОМЕР ГРУППЫ
RFCT А=В6,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=ADD,ALUD=В,RВ=DADR,ALU,YDST=MODGN
%J% А=МС39,МАР=РЕ
;
;
МОД1В:ENTRY
;===== ПИШЕМ АА/55 - В 0-Й МОДИФИКАТОР (АДР.- В МП); ЧИТАЕМ (АДР.- В RG1!!)
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD1B,МАР=РЕ
PSMD1B:CONT А=Н1В,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;CONST - В РГ.А
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;0 - В РЕГИСТР КОМАНД (RG1); ТКК И РЕЖИМ - ЛЮБЫЕ!
CONT ALUS=DZ,FUNC=AND,Н,ALU,ЕСВ,WRB,BRA=RG1
;ЦИКЛ: ПИШЕМ В 0-Й МОДИФИКТОР
CMOD1B:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В РГ.КОМАНД!
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TIK%
;ИНВЕРТИРУЕМ РГ.А
%J% А=CMOD1B,МАР=РЕ,ALUS=ZВ,RВ=А,FUNC=EXNOR,ALUD=В
;
;
MOД1D:ENTRY
;===== ПРОВЕРЯЕМ ЗАПРЕТ ЗАПИСИ В 0-Й МОДИФИКАТОР ПО АДРЕСУ ИЗ РГ.КОМАНД(!)
;   РГ.А - ЧТО ПИШЕМ; У - ЧИТАЕМ; Q - РЕЗ-Т СРАВНЕНИЯ
;   ОШИБКИ: 00 - НЕТ ЗАПИСИ В 0 МОД.ИЗ МП;
;   01 - ЕСТЬ ЗАПИСЬ В 0-Й МОДИФИКАТОР ПО АДРЕСУ IRA, ЧИТАЕМ ИЗ МП.
;   02 -    -   "   -   , ЧИТАЕМ ПО АДРЕСУ IRA.
;   ПРИ ОШ. 8-11 РГ.БОПП = A (ЧТО ПИШЕМ), 12-15 = Y (ЧТО ПРОЧИТАЛИ)
;
CJP А=PSMD1D,МАР=РЕ
PSMD1D:CONT А=H1D,%T%
%S% А=INITST,МАР=РЕ
;CONST - В РГ.А
CONT А=СААА,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А
;0 - В РЕГИСТР КОМАНД (RG1); ТКК И РЕЖИМ - ЛЮБЫЕ!
CONT ALUS=DZ,FUNC=AND,Н,ALU,ЕСВ,WRB,BRA=RG1
;ЦИКЛ: ПИШЕМ В 0-Й МОДИФИКТОР
CMOD1D:CONT ALUS=ZА,RА=А,ALU,CSM,WЕМ,MNSA=МР,MODNM=М0
;INTR = 00: ЧИТАЕМ, СРАВНИВАЕМ, АДРЕС МОДИФИКАТОРА - В РГ.КОМАНД!
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;ПИШЕМ ИНВЕРТИР.CONST В 0-Й МОДИФИКТОР ПО IRA! ЗАПИСИ НЕ Д.БЫТЬ!
CONT ALUS=ZВ,RВ=А,FUNC=EXNOR,Н,ALUD=В,ALU,CSM,WЕМ,MNSA=IRA
;01: ЧИТАЕМ, АДРЕС МОДИФИКАТОРА - В МП
CONT CSM,MNSA=МР,MODNM=М0,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАЛО!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
;02: ЧИТАЕМ, АДРЕС МОДИФИКАТОРА - В РГ.КОМАНД!
CONT CSM,MNSA=IRA,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,ALUD=Q,CEN
;ОШИБКА, ЕСЛИ СОВПАЛО!
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=NZ,%ТУРЕ%
%J% А=CMOD1D,МАР=РЕ,%TIK%
;
;     =============================================
;     ИЗМЕНЕНИЕ РГ. К О П  АРБИТРА ПОСЛЕ ФИЗ.АДРЕСА
;     =============================================
;
КОПА4:ENTRY
;===== ЗАПИСЬ ФИЗ.АДРЕСОМ ИЗ МИКРОПРОГРАММЫ - В РГ.КОП АРБИТРА;ЧТЕНИЕ;СРАВНЕНИЕ
;   РГ.А - CONST, СООТВЕТСТВУЮЩАЯ КОП АРБИТРА; РГ.У - ЧТО ПРОЧИТАЛИ
;   ПРИ ОШ.: 11 РГ.БОПП - ЧТО ДОЛЖНО БЫТЬ; 15 РГ.БОПП - ЧТО ПРОЧИТАЛИ
;
CJP А=CONTA4,МАР=РЕ
CONTA4:CONT А=Н4,%Т%
%S% А=INITST,МАР=РЕ
CONT А=CTEST,ALUS=DZ,ALU,YDST=CNT,FFCNT=SETNR
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ
;ПИШЕМ ЧЕГО-НИБУДЬ В АИСП. И В RG0, ЧТОБ НЕ БЫЛО, НАПР. "0 МАТ.АДРЕСА" И Т.Д.
CONT А=С1,DSRC=PROM,ALUS=DZ,ALU,YDST=ADRREG,ЕСВ,WRB,BRA=RG0
;00: ПРОВЕРЯЕМ КОП АРБИТРА = 0, ЧИТАЕМ СООТВЕТСТВУЮЩУЮ CONST ИЗ ПЗУ ДЛЯ СРАВНЕНИЯ
ССА4:CONT А=ZER,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=0
WА0:CJP А=WА0,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: КОП АРБИТРА = 1
CONT А=С1,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=CCRD
WА1:CJP А=WА1,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;02: КОП АРБИТРА = 2
CONT А=С2,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=CCWR
WА2:CJP А=WА2,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;03: КОП АРБИТРА = 3
CONT А=С3,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DCRD
WА3:CJP А=WА3,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;04: КОП АРБИТРА = 4
CONT А=С4,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DCWR
WА4:CJP А=WА4,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;05: КОП АРБИТРА = 8
CONT А=С8,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=FЕТСН
WА8:CJP А=WА8,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;06: КОП АРБИТРА = 9
CONT А=С9,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DRD
WА9:CJP А=WА9,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;07: КОП АРБИТРА = 10
CONT А=С10,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=DWR
WА10:CJP А=WА10,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;08: КОП АРБИТРА = 11
CONT А=С11,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=RDMWR
WА11:CJP А=WА11,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;09: КОП АРБИТРА = 12
CONT А=С12,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BTRWR
WА12:CJP А=WА12,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0A: КОП АРБИТРА = 13
CONT А=С13,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BTRRD
WА13:CJP А=WА13,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0B: КОП АРБИТРА = 14
CONT А=С14,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BICLR
WА14:CJP А=WА14,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
;0C: КОП АРБИТРА = 15
CONT А=С15,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=А,YDEV=PHYSAD,ARBI=BIRD
WА15:CJP А=WА15,%WA%
CONT DSRC=ARBOPC,ALUS=DА,RА=ВУТЕ,FUNC=AND,Н,ALUD=В,RВ=У
CONT ALUS=АВ,RА=А,RВ=У,FUNC=EXOR,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%TYPE%
%J% А=ССА4,МАР=РЕ,%TIK%
;
;     =========================================================
;     ФИЗ.АДРЕС + ЗАПИСЬ N СТРАНИЦЫ В РФС + ИЗМЕНЕНИЕ БОБР,БИЗМ
;     =========================================================
;
ФИЗА28:ENTRY
;===== Ф.А.+ N СТРАНИЦЫ В РФС + ИЗМЕНЕНИЕ БОБР,БИЗМ ПО 1 АДРЕСУ С БП=0,1
;   DADR - МАТ.АДРЕС; РС - ПРИПИСКА; HALF - ВЫЧИСЛЕННЫЙ ФИЗ.АДРЕС С БП=0;
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ; ВУТЕ = РР С БП=1;
;   ЧТОБ ИЗМЕНИЛИСЬ БОБР,БИЗМ, МАТ.АДРЕС НЕ ДОЛЖЕН ВЫЗЫВАТЬ ПРЕРЫВАНИЙ!
;   ОШИБКИ:
;   00 - НЕ ТОТ ФИЗ.АДРЕС С БП=1;              03 - ТО ЖЕ С БП=0;
;   01 - НЕ ТОТ НОМЕР СТРАНИЦЫ В РФС С БП=1;   04 - ТО ЖЕ С БП=0;
;   02 - НЕ ТЕ ЗНАЧЕНИЯ В БОБР,БИЗМ С БП=1;    05 - ТО ЖЕ С БП=0.
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;
CJP А=PSAD28,МАР=РЕ
PSAD28:CONT А=Н28,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;МАТ.АДРЕС ИЗ ПЗУ - В РГ.DADR, АИСП., В БОПП
CONT А=В3,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=DADR,H,ALUD=B,RB=WR6
;ПРИПИСКУ - В РС, В РП
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=РС,ALU,YDEV=PSMEM,WRY
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС (КОТОРЫЙ Д.БЫТЬ С ПРИПИСКОЙ): N СТРАНИЦЫ (11-20 РАЗРЯДЫ)
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=РС,FUNC=AND,Н,ALUD=В,RВ=HALF
;+ N СЛОВА В СТРАНИЦЕ (МЛАДШИЕ 10 РАЗРЯДОВ) - В РГ.HALF
CONT А=MWN,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=AND,Н,ALUD=Q
CONT ALUS=AQ,RА=HALF,FUNC=OR,Н,ALUD=В,RВ=HALF
;БП = 1
CADR28:CONT А=CTEST,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=ВУТЕ,ALU,YDST=CNT
;ОБНУЛЯЕМ БОБР,БИЗМ ПО ОБОИМ ФИЗ.АДРЕСАМ:
CONT ALUS=ZА,RА=DADR,ALUD=B,RB=A,ALU,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD,ALUS=ZА,RА=HALF,ALU,YDST=PHYSPG
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ С МАТ.АДРЕСОМ
CONT YDEV=PHYSAD,ARBI=DRD,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 0)
CONT A=B2,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;
;ТО ЖЕ САМОЕ С БП = 0
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
;03: ФИЗ.АДРЕС С ЗАМЕНОЙ N СТРАНИЦЫ
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=HALF,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,Н,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;04: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;05: ПРОВЕРЯЕМ БОБР(2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
%J% А=CADR28,МАР=РЕ,%TIK%
;
;
ФИЗА29:ENTRY
;===== ФИЗ.АДРЕС С БП=1 ( = МАТ.АДРЕСУ); ЦИКЛ ПО ВСЕМ АДРЕСАМ СТРАНИЦ
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРОВЕРЯЕМ УСТАНОВКУ БИЗМ=1.
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ;
;
CJP А=PSAD29,МАР=РЕ
PSAD29:CONT А=Н29,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;АДР."-1"-ОЙ СТРАНИЦЫ С РАЗМНОЖЕНИЕМ 20Р.В 21-32 - В РС, В WR1; БП=1
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;УСТАНАВЛИВАЕМ БОБР=1
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD,ALUS=ZА,RА=РС,ALU,YDST=ADRREG
;CONST - В РП (НЕ ВОСТРЕБУЕМАЯ ПРИПИСКА)
CONT А=С555,DSRC=PROM,ALUS=DZ,ALU,YDEV=PSMEM,WRY
;АДРЕС РП - В РФС (Т.К.С БП=1) ДЛЯ НОВОГО ЦИКЛА
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;
CADR29:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОД, ЕСЛИ М.А.= 0
CJP А=INCR29,МАР=РЕ,COND=СТ,SТОРС=NZ
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ С МАТ.АДРЕСОМ (БП = 1)
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=PC,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=А,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ ТОЛЬКО БОБР В 1 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD
INCR29:RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
%J% А=CADR29,МАР=РЕ,%TIK%
;
;
ФИЗА2А:ENTRY
;===== ЧТЕНИЕ ФИЗ.АДРЕСА С ПРИПИСКОЙ (БП = 0); ЦИКЛ ПО ВСЕМ АДРЕСАМ СТРАНИЦ
;   РС - МАТ.АДРЕС; DADR - ЗАПИСАННОЕ В РП, 11-20Р.= Ф.А, Т.К.1-10Р.М.А.= 0;
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ;
;
CJP А=PSAD2A,МАР=РЕ
PSAD2A:CONT А=Н2А,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
;АДР.НАЧАЛА БЕЗ 1 СТР.- ПИШЕМ В РС,WR1; БП = 0
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=ВУТЕ
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1,ALU,YDST=ADRREG
;CONST - В РП (ПРИПИСКА)
CONT А=С555,DSRC=PROM,ALUS=DZ,Н,ALUD=В,RВ=DADR,ALU,YDEV=PSMEM,WRY,YDST=PHYSPG
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;РП = CONST, ФИЗ.АДРЕС БУДЕТ ОДИН И ТОТ ЖЕ, ПИШЕМ ПО ЭТОМУ АДРЕСУ БОБР=БИЗМ=0
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=DADR,FUNC=AND,Н,ALUD=В,RВ=DADR
CADR2A:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОДИМ МАТ.АДРЕС = 0
CJP А=INCR2A,МАР=РЕ,COND=СТ,SТОРС=NZ
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ
CONT YDEV=PHYSAD,ARBI=FЕТСН,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=DADR,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 0)
CONT A=B2,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ БОБР,БИЗМ В 0 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
INCR2A:RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG,CEN
%J% А=CADR2A,МАР=РЕ,%TIK%
;
;
ФИЗА2В:ENTRY
;===== ФИЗ.АДРЕС С БП=0; ЦИКЛ ПО ВСЕМ МАТ.АДРЕСАМ И ФИЗ.АДРЕСАМ СТРАНИЦЫ И СЛОВА
;   РС - МАТ.АДРЕС; РП - ИНВЕРТИРОВАННЫЙ МАТ.АДРЕС.
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ
;
CJP А=PSAD2B,МАР=РЕ
PSAD2B:CONT А=Н2В,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETNR
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=ADRREG
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;ПИШЕМ ИНВЕРТИРОВАННЫЙ АДРЕС - В РП; 0 - В БОБР,БИЗМ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,YDEV=PSMEM,WRY,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;БП = 0
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=ВУТЕ
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
;МАТ. АДРЕС - В АИСП., НАЧИНАЯ С "-1"-ОЙ СТР., 0 СЛОВА (ЗДЕСЬ М.А.=0 НЕТ!)
CADR2B:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС:ИНВЕРТИРУЕМ НОМЕР СТРАНИЦЫ У МАТ.АДРЕСА (ТАК ЗАПИСАНО В РП)
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,ALUD=В,RВ=A
;00: ЧИТАЕМ  ФИЗ.АДРЕС, СРАВНИВАЕМ
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG2,ЕСА,ARA=RG2,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
CONT А=MADR,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР(2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=РССОРУ
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ БОБР,БИЗМ В 0 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
RFCT А=PG1W1,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,ALUD=В,RВ=РС,ALU,YDST=ADRREG
%J% А=CADR2B,МАР=РЕ,%TIK%
;
;
ФИЗА2C:ENTRY
;===== ФИЗ.АДРЕС С БП=1 В РЭ!!! ( = МАТ.АДРЕСУ); ЦИКЛ ПО ВСЕМ АДРЕСАМ СТРАНИЦ
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРОВЕРЯЕМ УСТАНОВКУ БИЗМ=1.
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ;
;
CJP А=PSAD2C,МАР=РЕ
PSAD2C:CONT А=Н2C:%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
;АДР."-1"-ОЙ СТРАНИЦЫ С РАЗМНОЖЕНИЕМ 20Р.В 21-32 - В РС, В WR1; БП=1
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALU,YDST=CNT
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;УСТАНАВЛИВАЕМ БОБР=1
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD,ALUS=ZА,RА=РС,ALU,YDST=ADRREG
;CONST - В РП (НЕ ВОСТРЕБУЕМАЯ ПРИПИСКА)
CONT А=С555,DSRC=PROM,ALUS=DZ,ALU,YDEV=PSMEM,WRY
;АДРЕС РП - В РФС (Т.К.С БП=1) ДЛЯ НОВОГО ЦИКЛА
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=PHYSPG
;
CADR2C:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,ALUD=В,RВ=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОД, ЕСЛИ МЛАДШИЕ 15 РАЗРЯДОВ МАТ.АДРЕСА В РЭ = 0
CONT A=MADR,DSRC=PROM,ALUS=DA,RA=PC,FUNC=AND,CEN
CJP А=INCR2C,МАР=РЕ,COND=СТ,SТОРС=NZ
;00: ЧИТАЕМ ФИЗ.АДРЕС, СРАВНИВАЕМ С МАТ.АДРЕСОМ (БП = 1)
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG1,ЕСА,ARA=RG1,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=ZA,RA=PC,ALUD=B,RB=A
CONT ALUS=АВ,RА=A,RВ=А,FUNC=EXOR,ALUD=Q
;В РЭ СРАВНИВАЕМ ТОЛЬКО 15 РАЗРЯДОВ!!!
CONT А=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
;В РЭ ОСТАВЛЯЕМ ТОЛЬКО 5 МЛАДШИХ РАЗРЯДОВ У НОМЕРА СТРАНИЦЫ!!!
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР (2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ ТОЛЬКО БОБР В 1 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=В2,DSRC=PROM,DDEV=ВВ,WRD
INCR2C:RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
%J% А=CADR2C,МАР=РЕ,%TIK%
;
;
ФИЗА2D:ENTRY
;===== ФИЗ.АДРЕС С БП=0 В РЭ!!! ЦИКЛ ПО ВСЕМ МАТ.АДР. И ФИЗ.АДР.СТРАНИЦЫ И СЛОВА
;   РС - МАТ.АДРЕС; РП - ИНВЕРТИРОВАННЫЙ МАТ.АДРЕС.
;   Y - ПРОЧИТАННЫЙ ФИЗ.АДРЕС, НОМЕР СТРАНИЦЫ ИЗ РФС ИЛИ БОБР,БИЗМ;
;   A - ТО, ЧТО Д.БЫТЬ; Q - РЕЗ-Т СРАВНЕНИЯ;
;   ПРИ ОШ. 8-11 РГ.БОПП = ЧТО Д.Б., 12-15 = ЧТО ПРОЧИТАЛИ, 4-7 = МАТ.АДРЕС
;   ОШИБКИ: 00 - НЕ ТОТ ФИЗ.АДРЕС; 01 - N СТРАНИЦЫ В РФС; 02 - НЕ ТЕ БОБР,БИЗМ
;
CJP А=PSAD2D,МАР=РЕ
PSAD2D:CONT А=Н2D,%T%
%S% А=INITST,МАР=РЕ,FFCNT=SETER
CONT А=В20,DSRC=PROM,ALUS=DZ,FUNC=SUBR,Н,CI,ALUD=В,RВ=РС,ALU,YDST=ADRREG
PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=РС,Н,ALUD=В,RВ=WR1
;ПИШЕМ ИНВЕРТИРОВАННЫЙ АДРЕС - В РП; 0 - В БОБР,БИЗМ
CONT ALUS=ZА,RА=РС,FUNC=EXNOR,ALU,YDEV=PSMEM,WRY,YDST=PHYSPG
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
RFCT А=В11,DSRC=PROM,ALUS=DА,RА=РС,ALUD=В,RВ=РС,ALU,YDST=ADRREG
;БП = 0
CONT А=CTEST,DSRC=PROM,ALUS=DZ,ALUD=В,RВ=ВУТЕ
CONT А=В27,DSRC=PROM,ALUS=DА,RА=ВУТЕ,FUNC=EXOR,ALU,YDST=CNT
;МАТ. АДРЕС - В АИСП., НАЧИНАЯ С "-1"-ОЙ СТР., 0 СЛОВА (ЗДЕСЬ М.А.=0 НЕТ!)
CADR2D:PUSH А=1023,МАР=РЕ,ALUS=ZА,RА=WR1,Н,ALUD=В,RВ=РС,ALU,YDST=ADRREG
CJS A=OUT4/7,MAP=PE,ALUS=ZA,RA=PC,H,ALUD=B,RB=WR6
;ОБХОД, ЕСЛИ МЛ.15 РАЗРЯДОВ АДРЕСА = 0
CONT A=M15,DSRC=PROM,ALUS=DA,RA=PC,FUNC=AND,CEN
CJP A=INCR2D,MAP=PE,COND=CT,STOPC=NZ
;ВЫЧИСЛЯЕМ ФИЗ.АДРЕС:ИНВЕРТИРУЕМ НОМЕР СТРАНИЦЫ У МАТ.АДРЕСА (ТАК ЗАПИСАНО В РП)
CONT А=MPG,DSRC=PROM,ALUS=DА,RА=РС,FUNC=EXOR,ALUD=В,RВ=A
;00: ЧИТАЕМ  ФИЗ.АДРЕС, СРАВНИВАЕМ
CONT YDEV=PHYSAD,ARBI=DWR,ЕСВ,WRB,BRA=RG2,ЕСА,ARA=RG2,ALUS=DZ,ALUD=В,RВ=Y
CONT ALUS=АВ,RА=A,RВ=Y,FUNC=EXOR,ALUD=Q
;ОСТАВЛЯЕМ ТОЛЬКО МЛАДШИЕ 15 РАЗРЯДОВ АДРЕСА В РЭ
CONT А=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%CLRTYP%
;01: СРАВНИВАЕМ РФС
CONT DSRC=PHYSPG,ALUS=DZ,ALUD=В,RВ=У
CONT ALUS=АВ,RА=A,RВ=У,FUNC=EXOR,ALUD=Q
;ОСТАВЛЯЕМ ТОЛЬКО МЛ.5 НОМЕРОВ СТРАНИЦ В РЭ
CONT A=M15,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q
CONT А=MPG,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;02: ПРОВЕРЯЕМ БОБР(2 РАЗРЯД = 1), БИЗМ (3 РАЗРЯД = 1)
CONT A=C6,DSRC=PROM,ALUS=DZ,ALUD=B,RB=A
CONT DDEV=ВВ,ALUS=DZ,ALUD=В,RВ=РССОРУ
CONT ALUS=AB,RА=A,RB=Y,FUNC=EXOR,ALUD=Q
CONT А=С6,DSRC=PROM,ALUS=DQ,FUNC=AND,ALUD=Q,CEN
CJS А=ERRINH,МАР=РЕ,COND=СТ,SТОРС=/NZ,%ТУРЕ%
;СНОВА УСТАНАВЛИВАЕМ БОБР,БИЗМ В 0 (ДЛЯ ОЧЕРЕДНОГО ЦИКЛА)
CONT А=ZER,DSRC=PROM,DDEV=ВВ,WRD
INCR2D:RFCT А=PG1W1,DSRC=PROM,ALUS=DА,RА=РС,FUNC=ADD,ALUD=В,RВ=РС,ALU
>,YDST=ADRREG
%J% А=CADR2D,МАР=РЕ,%TIK%
;
;
;===== ПОСЛЕДНЯЯ КОМАНДА БОЛЬШОГО ТЕСТА
;
CJP A=OCTCKL,MAP=PE
END
*NO LIST
OCTLD:PROG;
;===== СПИСОК ЗАГРУЖАЕМЫХ ПРОГРАММ:
EXTERN MPCONT,OCT
END
*END
*NO LIST
*CALL MICLOA:OCTLD
*CALL MPROM
*END F
*END FILE
